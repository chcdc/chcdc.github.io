<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Carlos Carvalho - Carlos Carvalho</title><link href="https://blog.chcdc.com.br/" rel="alternate"></link><link href="https://blog.chcdc.com.br/feeds/carlos-carvalho.atom.xml" rel="self"></link><id>https://blog.chcdc.com.br/</id><updated>2021-06-22T22:27:45-02:00</updated><subtitle>Yet Another Blog</subtitle><entry><title>Git Comandos B√°sicos</title><link href="https://blog.chcdc.com.br/posts/git-comandos-basicos" rel="alternate"></link><published>2021-06-22T22:27:45-02:00</published><updated>2021-06-22T22:27:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2021-06-22:/posts/git-comandos-basicos</id><summary type="html">&lt;p&gt;Seguindo a sequencia, nesse post vamos iniciar o git com os comandos b√°sicos.&lt;/p&gt;
&lt;p&gt;Os conceitos eu abordei &lt;a href="/posts/git-conceitos-e-historia/#os-tres-estados"&gt;aqui&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Para esse Post, vamos utilizar um sistema baseado em Linux, por√©m os comandos s√£o similares para sistemas ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Seguindo a sequencia, nesse post vamos iniciar o git com os comandos b√°sicos.&lt;/p&gt;
&lt;p&gt;Os conceitos eu abordei &lt;a href="/posts/git-conceitos-e-historia/#os-tres-estados"&gt;aqui&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Para esse Post, vamos utilizar um sistema baseado em Linux, por√©m os comandos s√£o similares para sistemas Windows e MacOS.&lt;/p&gt;
&lt;!--more--&gt;
&lt;div class="toc"&gt;&lt;span class="toctitle"&gt;Indice:&lt;/span&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#instalacao"&gt;Instala√ß√£o&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#configuracao-basica"&gt;Configura√ß√£o B√°sica&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#configurando-nome-e-email"&gt;Configurando nome e email&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#configurando-preferencias"&gt;Configurando preferencias&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#criando-um-projeto-git"&gt;Criando um projeto git&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h3 id="instalacao"&gt;Instala√ß√£o&lt;/h3&gt;
&lt;p&gt;Em sua grande maioria de sistemas linux pode ser obtido da seguinte forma:&lt;/p&gt;
&lt;p&gt;Debian like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="go"&gt;sudo apt install git&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;RedHat Like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="go"&gt;sudo yum install git&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para windows pode ser obtido &lt;a href="https://git-scm.com/download/win"&gt;aqui&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="configuracao-basica"&gt;Configura√ß√£o B√°sica&lt;/h3&gt;
&lt;p&gt;Para utilizar o git em sua maquina, precisamos primeiro configurar o autor. Pelo motivo de que todos os &lt;em&gt;commits&lt;/em&gt; devem ser identificados.&lt;/p&gt;
&lt;p&gt;O arquivo &lt;code&gt;/etc/gitconfig&lt;/code&gt; cont√©m valores de configura√ß√£o para todos usu√°rios do sistema e todos os seus reposit√≥rios.
Se voc√™ passar a op√ß√£o --system para git config, ele ler√° e escrever√° a partir deste arquivo especificamente.&lt;/p&gt;
&lt;p&gt;O arquivo &lt;code&gt;~/.gitconfig&lt;/code&gt; √© espec√≠fico para seu usu√°rio.
Voc√™ pode fazer o Git ler e escrever a partir deste arquivo passando a op√ß√£o --global.&lt;/p&gt;
&lt;p&gt;Em sistemas Windows, Git procura pelo arquivo &lt;code&gt;.gitconfig&lt;/code&gt; no diret√≥rio &lt;code&gt;$HOME&lt;/code&gt;.
Isto significa um dos diret√≥rios a seguir: &lt;code&gt;C:\Documents&lt;/code&gt; e &lt;code&gt;Settings\$USER&lt;/code&gt;, para a maioria dos usu√°rios.&lt;/p&gt;
&lt;h4 id="configurando-nome-e-email"&gt;Configurando nome e email&lt;/h4&gt;
&lt;p&gt;Podemos definir seu nome e email para serem adicionados como autor nos &lt;em&gt;commits&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;A configura√ß√£o global no sistema √© feita utilizando o seguinte comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git config --global user.name &lt;span class="s2"&gt;&amp;quot;Carlos Carvalho&amp;quot;&lt;/span&gt;
&lt;span class="gp"&gt;$ &lt;/span&gt;git config --global user.email carlos@chcdc.com.br
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;N√£o se esque√ßa de alterar as informa√ß√µes, n√£o quero ser dono dos seus &lt;em&gt;commits&lt;/em&gt;&lt;/p&gt;
&lt;h4 id="configurando-preferencias"&gt;Configurando preferencias&lt;/h4&gt;
&lt;p&gt;Vamos definir o editor &lt;em&gt;vim&lt;/em&gt; como padr√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git config --global core.editor vim
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Configurar o Prompt colorido:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git config --global color.ui &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Essas configura√ß√µes j√° s√£o suficientes para continuarmos, caso queira ver todas as configura√ß√µes, basta rodar o comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git config --list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para listar uma configura√ß√£o espec√≠fica, por exemplo o user.name:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git config user.name
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="criando-um-projeto-git"&gt;Criando um projeto git&lt;/h3&gt;
&lt;p&gt;Para iniciar um reposit√≥rio basta executar &lt;code&gt;git init&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Lembrando que √© necess√°rio estar no diret√≥rio do projeto em que se deseja utilizar o GIT&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; projeto
&lt;span class="gp"&gt;$ &lt;/span&gt;git init
&lt;span class="go"&gt;Initialized empty Git repository in projeto/.git/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos criar o arquivo &lt;code&gt;README.md&lt;/code&gt;, ele √© um arquivo de apresenta√ß√£o. Ele inicialmente ser√° a nossa base&lt;/p&gt;
&lt;p&gt;Use o editor de texto de sua prefer√™ncia, aqui usarei vim&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;vim README.md
&lt;span class="gp"&gt;$ &lt;/span&gt;cat README.md
&lt;span class="go"&gt;Iniciando um repositorio&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos dar um &lt;code&gt;git status&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git status
&lt;span class="go"&gt;On branch main&lt;/span&gt;

&lt;span class="go"&gt;No commits yet&lt;/span&gt;

&lt;span class="go"&gt;Untracked files:&lt;/span&gt;
&lt;span class="go"&gt;  (use &amp;quot;git add &amp;lt;file&amp;gt;...&amp;quot; to include in what will be committed)&lt;/span&gt;
&lt;span class="go"&gt;        README.md&lt;/span&gt;

&lt;span class="go"&gt;nothing added to commit but untracked files present (use &amp;quot;git add&amp;quot; to track)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Como podemos ver arquivo esta &lt;code&gt;Untracked&lt;/code&gt;, para adicionar ele vamos executar o &lt;code&gt;git add&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git add README.md
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Se rodarmos o &lt;code&gt;git status&lt;/code&gt; novamente, veremos que agora o arquivo README.md esta pronto para &lt;em&gt;commit&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git status
&lt;span class="go"&gt;On branch master&lt;/span&gt;

&lt;span class="go"&gt;No commits yet&lt;/span&gt;

&lt;span class="go"&gt;Changes to be committed:&lt;/span&gt;
&lt;span class="go"&gt;  (use &amp;quot;git rm --cached &amp;lt;file&amp;gt;...&amp;quot; to unstage)&lt;/span&gt;
&lt;span class="go"&gt;        new file:   README.md&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora vamos executar o commit, para isso vamos usar o comando &lt;code&gt;git commit -m&lt;/code&gt; . O par√¢metro &lt;code&gt;m&lt;/code&gt; indica qual a mensagem que deseja passar no &lt;em&gt;commit&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git commit -m &lt;span class="s2"&gt;&amp;quot;Adicionando meu README.md&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;[master (root-commit) ef567d0] Adicionando meu README.md&lt;/span&gt;
&lt;span class="go"&gt; 1 file changed, 2 insertions(+)&lt;/span&gt;
&lt;span class="go"&gt; create mode 100644 README.md&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pronto, fizemos o nosso primeiro &lt;em&gt;commit&lt;/em&gt;!!&lt;/p&gt;
&lt;p&gt;Podemos ver nossas altera√ß√µes utilizando o &lt;code&gt;git log&lt;/code&gt;.
Onde temos o hash do commit, o author do commit e a data em que o commit foi realizado. (Talvez meu commit seja do futuro!)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git log
&lt;span class="go"&gt;commit ef567d0a3cef19e36ee75fd9251ebfb929a10b46 (HEAD -&amp;gt; master)&lt;/span&gt;
&lt;span class="go"&gt;Author: Carlos Carvalho &amp;lt;carlos@chcdc.com.br&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;Date:   Tue Jan 18 21:22:23 2061 -0300&lt;/span&gt;

&lt;span class="go"&gt;    Adicionando meu README.md&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O proximo comando √© o &lt;code&gt;git diff&lt;/code&gt;.
Ent√£o vamos fazer uma altera√ß√£o no &lt;code&gt;README.md&lt;/code&gt;. 
Fa√ßa a edi√ß√£o no seu editor favorito.&lt;/p&gt;
&lt;p&gt;Ao executar o &lt;code&gt;git diff&lt;/code&gt; temos a seguinte saida:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git diff
&lt;span class="go"&gt;diff --git a/README.md b/README.md&lt;/span&gt;
&lt;span class="go"&gt;index abb520e..f603704 100644&lt;/span&gt;
&lt;span class="go"&gt;--- a/README.md&lt;/span&gt;
&lt;span class="go"&gt;+++ b/README.md&lt;/span&gt;
&lt;span class="go"&gt;@@ -1,2 +1,2 @@&lt;/span&gt;
&lt;span class="go"&gt;-Iniciando um reposit√≥rio&lt;/span&gt;
&lt;span class="go"&gt;+### Novo Projeto de coloniza√ß√£o lunar&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Nesse exemplo, removemos o texto &lt;strong&gt;Iniciando um reposit√≥rio&lt;/strong&gt; e inserimos o texto &lt;strong&gt;Novo Projeto de coloniza√ß√£o lunar&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver, ele mostrou, utilizando o simbolo &lt;em&gt;+&lt;/em&gt;, o que adicionamos e utilizando o simbolo &lt;em&gt;-&lt;/em&gt;, o que removemos.&lt;/p&gt;
&lt;p&gt;O &lt;code&gt;git diff&lt;/code&gt; nos permite ver qualquer altera√ß√£o antes de fazer o &lt;em&gt;commit&lt;/em&gt;, ele se torna um dos comandos mais importantes no workflow, sempre utilize ele pois assim pode revisar o que esta enviando.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Lembrando que o &lt;code&gt;git diff&lt;/code&gt; deve ser executado antes de adicionarmos o arquivo em staging&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Vamos adicionar o arquivo e fazer o commit dessas mudan√ßas&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;git add README.md
&lt;span class="gp"&gt;$ &lt;/span&gt;git commit -m &lt;span class="s2"&gt;&amp;quot;Novo projeto lunar&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;[master 014982d] Novo projeto lunar&lt;/span&gt;
&lt;span class="go"&gt; 1 file changed, 1 insertion(+), 1 deletion(-)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Como resultado ele nos mostrou que houve:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1 arquivo alterado (README.md)&lt;/li&gt;
&lt;li&gt;1 inser√ß√£o (### Novo Projeto de coloniza√ß√£o lunar)&lt;/li&gt;
&lt;li&gt;1 remo√ß√£o (Iniciando um reposit√≥rio)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ent√£o nesse post vimos como criar um reposit√≥rio local , inserir arquivos, ver altera√ß√µes, adicionar e fazer o commit dos arquivos.&lt;/p&gt;
&lt;p&gt;Com esses comandos j√° podemos trabalhar com o b√°sico do git.&lt;/p&gt;
&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;
&lt;p&gt;&lt;a href="http://git-scm.com/book/pt-br"&gt;Fonte&lt;/a&gt;&lt;/p&gt;</content><category term="DevOps"></category><category term="git"></category></entry><entry><title>Git Conceitos b√°sicos e Hist√≥ria</title><link href="https://blog.chcdc.com.br/posts/git-conceitos-basicos-e-historia" rel="alternate"></link><published>2021-06-22T22:27:45-02:00</published><updated>2021-06-22T22:27:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2021-06-22:/posts/git-conceitos-basicos-e-historia</id><summary type="html">&lt;p&gt;Nesse post vamos falar um pouco sobre a hist√≥ria e os conceitos b√°sicos do GIT.&lt;/p&gt;
&lt;!-- PELICAN_END_SUMMARY --&gt;

&lt;h3 id="historia"&gt;Historia&lt;/h3&gt;
&lt;p&gt;O n√∫cleo (kernel) do Linux √© um projeto de c√≥digo aberto com um escopo bastante grande.&lt;/p&gt;
&lt;p&gt;Em 2002, o ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nesse post vamos falar um pouco sobre a hist√≥ria e os conceitos b√°sicos do GIT.&lt;/p&gt;
&lt;!-- PELICAN_END_SUMMARY --&gt;

&lt;h3 id="historia"&gt;Historia&lt;/h3&gt;
&lt;p&gt;O n√∫cleo (kernel) do Linux √© um projeto de c√≥digo aberto com um escopo bastante grande.&lt;/p&gt;
&lt;p&gt;Em 2002, o projeto do n√∫cleo do Linux come√ßou usar uma DVCS propriet√°ria chamada BitKeeper.&lt;/p&gt;
&lt;p&gt;Em 2005, a rela√ß√£o entre a comunidade que desenvolveu o n√∫cleo do Linux e a empresa que desenvolveu BitKeeper quebrou em peda√ßos, e a ferramenta passou a ser paga.&lt;/p&gt;
&lt;p&gt;Isto alertou a comunidade que desenvolvia o Linux (e especialmente Linus Torvalds, o criador do Linux) a desenvolver a sua pr√≥pria ferramenta baseada em li√ß√µes aprendidas ao usar o BitKeeper.&lt;/p&gt;
&lt;p&gt;Algumas metas do novo sistema era os seguintes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Velocidade&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Projeto simples&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Forte suporte para desenvolvimento n√£o-linear (milhares de ramos paralelos)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Completamente distribu√≠do&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Capaz de lidar com projetos grandes como o n√∫cleo o Linux com efici√™ncia (velocidade e tamanho dos dados)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Desde seu nascimento em 2005, Git evoluiu e amadureceu para ser f√°cil de usar e ainda reter essas qualidades iniciais.&lt;/p&gt;
&lt;p&gt;Ele √© incrivelmente r√°pido, √© muito eficiente com projetos grandes, e ele tem um incr√≠vel sistema de ramos para desenvolvimento n√£o linear&lt;/p&gt;
&lt;h3 id="como-funciona"&gt;Como Funciona&lt;/h3&gt;
&lt;p&gt;O Git considera que os dados s√£o como uma imagem do sistema de arquivos.&lt;/p&gt;
&lt;p&gt;Toda vez que voc√™ fizer um commit, ou salvar o estado de seu projeto no Git, ele basicamente tira uma foto de todos os seus arquivos e armazena uma refer√™ncia para esse conjunto de arquivos.&lt;/p&gt;
&lt;p&gt;Para ser eficiente, se os arquivos n√£o foram alterados, o Git n√£o armazena o arquivo novamente, apenas um link para o arquivo id√™ntico anterior j√° armazenado.
O Git trata seus dados mais como um fluxo do estado dos arquivos.&lt;/p&gt;
&lt;p&gt;&lt;img alt="git-snapshot" src="/images/snapshots-git.png"&gt;&lt;/p&gt;
&lt;h3 id="principais-caracteristicas"&gt;Principais Caracter√≠sticas&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;As opera√ß√µes s√£o locais&lt;/li&gt;
&lt;li&gt;Tem integridade checksum&lt;/li&gt;
&lt;li&gt;Geralmente s√≥ adiciona dados&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="os-tres-estados"&gt;Os tr√™s estados&lt;/h3&gt;
&lt;p&gt;O git tem tres estados principais que seus arquivos podem estar:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Committed&lt;/strong&gt;: Os dados est√£o armazenados de forma segura em seu banco de dados local.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Modified&lt;/strong&gt;: Significa que o arquivo foi alterado, mas ainda n√£o fez o commit no seu banco de dados.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Staged&lt;/strong&gt;: Significa que voc√™ marcou a vers√£o atual de um arquivo modificado para fazer parte do seu pr√≥ximo commit&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="workflow"&gt;Workflow&lt;/h3&gt;
&lt;p&gt;O fluxo de trabalho podemos descrever da seguinte forma:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Voc√™ modifica arquivos no seu diret√≥rio de trabalho&lt;/li&gt;
&lt;li&gt;Seleciona os arquivos, adicionando imagens deles √† sua area de trabalho&lt;/li&gt;
&lt;li&gt;Voc√™ faz o commit, que leva os arquivos como eles est√£o na sua √°rea de prepara√ß√£o e os armazena permanentemente no seu diret√≥rio Git.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Workflow GIT" src="/images/workflow-git.png"&gt;&lt;/p&gt;
&lt;h3 id="repositorios-locais"&gt;Reposit√≥rios Locais&lt;/h3&gt;
&lt;p&gt;Seus reposit√≥rios locais consistem em tr√™s "√°rvores" mantidas pelo git&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Working Directory&lt;/strong&gt; : Cont√©m os arquivos vigentes&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Index&lt;/strong&gt; : Funciona como uma √°rea tempor√°ria (stage)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HEAD&lt;/strong&gt; : Aponta para o ultimo commit feito&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Workflow GIT Directories" src="/images/workflow-git-dir.png"&gt;&lt;/p&gt;
&lt;p&gt;A partir de um estado "n√£o gerenciado", os arquivos entram em um ciclo de altera√ß√µes de estado a cada modifica√ß√£o e posterior consolida√ß√£o.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Workflow GIT States" src="/images/states-git.png"&gt;&lt;/p&gt;
&lt;p&gt;Esses s√£o os conceitos iniciais do GIT, nos pr√≥ximos posts vamos executar a instala√ß√£o e fazer alguns commits e altera√ß√µes.&lt;/p&gt;
&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;
&lt;p&gt;&lt;a href="http://git-scm.com/book/pt-br"&gt;Fonte&lt;/a&gt;&lt;/p&gt;</content><category term="DevOps"></category><category term="git"></category></entry><entry><title>Migrando reposit√≥rios do SVN para o GIT</title><link href="https://blog.chcdc.com.br/posts/migrando-repositorios-do-svn-para-o-git" rel="alternate"></link><published>2019-12-14T19:12:45-03:00</published><updated>2019-12-14T19:12:45-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2019-12-14:/posts/migrando-repositorios-do-svn-para-o-git</id><summary type="html">&lt;p&gt;Nesse post vou mostrar como migrar projetos do svn para o git.&lt;/p&gt;
&lt;p&gt;Vou partir do principio que j√° entende como o &lt;a href="https://subversion.apache.org/"&gt;Subversion&lt;/a&gt; e o &lt;a href="https://git-scm.com/"&gt;Git&lt;/a&gt; se comportam.&lt;/p&gt;
&lt;p&gt;Para tudo ocorrer como esperado, o nosso ambiente ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nesse post vou mostrar como migrar projetos do svn para o git.&lt;/p&gt;
&lt;p&gt;Vou partir do principio que j√° entende como o &lt;a href="https://subversion.apache.org/"&gt;Subversion&lt;/a&gt; e o &lt;a href="https://git-scm.com/"&gt;Git&lt;/a&gt; se comportam.&lt;/p&gt;
&lt;p&gt;Para tudo ocorrer como esperado, o nosso ambiente precisa estar seguinte forma:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cliente svn instalado&lt;/li&gt;
&lt;li&gt;Cliente git mais recente instalado&lt;/li&gt;
&lt;li&gt;Pacote git-svn&lt;/li&gt;
&lt;li&gt;PATH configurado que inclua o cliente git,svn e git-svn&lt;/li&gt;
&lt;/ul&gt;
&lt;!--more--&gt;

&lt;p&gt;Primeiramente vamos obter os autores do repositorio svn&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/
$ svn log --no-auth-cache -q http://svn.yourcompany/svn/repos/sample-repo/ &lt;span class="se"&gt;\ &lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt; awk -F &lt;span class="s1"&gt;&amp;#39;|&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/^r/ {sub(&amp;quot;^ &amp;quot;, &amp;quot;&amp;quot;, $2);&lt;/span&gt;
&lt;span class="s1"&gt;        sub(&amp;quot; $&amp;quot;, &amp;quot;&amp;quot;, $2); print $2&amp;quot; = &amp;quot;$2&amp;quot; &amp;lt;&amp;quot;$2&amp;quot;&amp;gt;&amp;quot;}&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt; sort -u &amp;gt;authors-transform.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora vamos 'clonar' localmente o nosso repositorio, esse processo pode demorar horas dependendo do tamanho do repositorio. Aqui o --stdlayout indica que o reposit√≥rio segue o modelo tradicional, com pastas trunk, tags e branches.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/
$ git svn --username &amp;lt;usuario&amp;gt; --password &amp;lt;password&amp;gt; &lt;span class="se"&gt;\&lt;/span&gt;
  clone http://svn.yourcompany/svn/repos/sample-repo/ &lt;span class="se"&gt;\&lt;/span&gt;
  --no-metadata -A authors-transform.txt --stdlayout
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ap√≥s finalizar, vamos criar um repositorio git do tipo bare e vamos indicar que o branch atual √© o trunk&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ mkdir -p ~/sample-repo.git
$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/sample-repo.git
$ git init --bare
$ git symbolic-ref HEAD refs/heads/trunk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora temos um clone completo do reposit√≥rio svn no diret√≥rio sample-repo, e um reposit√≥rio git bare em sample-repo.git Vamos fazer um push do reposit√≥rio svn clonado para o reposit√≥rio git local. Configuramos tambem para que o push seja dos branches refs/remotes e dos refs/heads.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/sample-repo
$ git remote add bare ~/sample-repo.git
$ git config remote.bare.push &lt;span class="s1"&gt;&amp;#39;refs/remotes/*:refs/heads/*&amp;#39;&lt;/span&gt;
$ git push bare
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;No final do passo anterior, o reposit√≥rio svn ser√° copiado para o git, mas precisaremos acertar algumas conven√ß√µes git. Vamos renomear Trunk para *Master&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/sample-repo.git
$ git branch -m trunk master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Precisaremos fazer uma limpeza de branches no git.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/sample-repo.git
$ git &lt;span class="k"&gt;for&lt;/span&gt;-each-ref --format&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;%(refname)&amp;#39;&lt;/span&gt; refs/heads/origin/tags &lt;span class="p"&gt;|&lt;/span&gt;
  cut -d / -f &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
  &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read&lt;/span&gt; ref
    &lt;span class="k"&gt;do&lt;/span&gt;
      &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$ref&lt;/span&gt;
      &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
      git tag &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$ref&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;origin/tags/&lt;/span&gt;&lt;span class="nv"&gt;$ref&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      git branch -D &lt;span class="s2"&gt;&amp;quot;origin/tags/&lt;/span&gt;&lt;span class="nv"&gt;$ref&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;E pra finalizar, vamos fazer o push para o servidor git da empresa&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; ~/sample-repo.git
$ git remote add origin https://username:password@gitserver/repo-sample
$ git push -u origin --all
$ git push -u origin --tags
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para facilitar o processo, criei um script para executar com maior facilidade.&lt;/p&gt;
&lt;p&gt;Ele se encontra abaixo e no meu &lt;a href="https://github.com/chcdc/svntogit/blob/master/run-import.sh"&gt;Github&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Bons commits!! :)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash &lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; -z &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; -z &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$2&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Argument Null. Exiting&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="nv"&gt;$1&lt;/span&gt; !&lt;span class="o"&gt;=&lt;/span&gt; http?&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;://svn/* &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nv"&gt;$2&lt;/span&gt; !&lt;span class="o"&gt;=&lt;/span&gt; git@git* &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Invalid URL. Exiting&amp;quot;&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;How to insert parameters:\n&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;0&lt;/span&gt;&lt;span class="p"&gt;##*/&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; SVN GIT&amp;quot;&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="nv"&gt;SVN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;
        &lt;span class="nv"&gt;REPO_GIT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$2&lt;/span&gt;
    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="nb"&gt;alias&lt;/span&gt; &lt;span class="nv"&gt;svn&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;svn --non-interactive --trust-server-cert&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;PROJECT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;SVN&lt;/span&gt;&lt;span class="p"&gt;##*/&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; create_dirs&lt;span class="o"&gt;(){&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Creating Directories &lt;/span&gt;&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;---------------------------------------------&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; -d ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Removing old directories | &lt;/span&gt;&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;&lt;span class="s2"&gt;.git&amp;quot;&lt;/span&gt;
        rm -rf ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git
    &lt;span class="k"&gt;fi&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; -d ~/repo-&lt;span class="nv"&gt;$PROJECT&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Removing old directories  | repo-&lt;/span&gt;&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
        rm -rf ~/repo-&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;
    &lt;span class="k"&gt;fi&lt;/span&gt;
    mkdir -p ~/repo-&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;
    mkdir -p ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Directories created&amp;quot;&lt;/span&gt;
        clone_repo_svn
    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; clone_repo_svn&lt;span class="o"&gt;(){&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; ~/repo-&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Cloning repositories SVN - &lt;/span&gt;&lt;span class="nv"&gt;$SVN&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;---------------------------------------------&amp;quot;&lt;/span&gt;
    svn log --no-auth-cache -q &lt;span class="nv"&gt;$SVN&lt;/span&gt; &lt;span class="se"&gt;\ &lt;/span&gt;
        &lt;span class="p"&gt;|&lt;/span&gt; awk -F &lt;span class="s1"&gt;&amp;#39;|&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/^r/ {sub(&amp;quot;^ &amp;quot;, &amp;quot;&amp;quot;, $2); \&lt;/span&gt;
&lt;span class="s1"&gt;                sub(&amp;quot; $&amp;quot;, &amp;quot;&amp;quot;, $2); print $2&amp;quot; = &amp;quot;$2&amp;quot; &amp;lt;&amp;quot;$2&amp;quot;&amp;gt;&amp;quot;}&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
        &lt;span class="p"&gt;|&lt;/span&gt; sort -u &amp;gt;authors-transform.txt
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;time&lt;/span&gt; git svn clone &lt;span class="nv"&gt;$SVN&lt;/span&gt; --no-metadata -A authors-transform.txt --stdlayout 
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; -eq &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Error cloning repositories\n&amp;quot;&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;
        git_config
    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;


&lt;span class="k"&gt;function&lt;/span&gt; git_config&lt;span class="o"&gt;(){&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Convert to GIT - &lt;/span&gt;&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;---------------------------------------------&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git
    git init --bare
    git symbolic-ref HEAD refs/heads/trunk
    &lt;span class="nb"&gt;cd&lt;/span&gt; ~/repo-&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;
    git remote add bare ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git/
    git config remote.bare.push &lt;span class="s1"&gt;&amp;#39;refs/remotes/*:refs/heads/*&amp;#39;&lt;/span&gt;
    git push bare
    &lt;span class="nb"&gt;cd&lt;/span&gt; ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git/
    git branch -m origin/trunk master
    git &lt;span class="k"&gt;for&lt;/span&gt;-each-ref --format&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;%(refname)&amp;#39;&lt;/span&gt; refs/heads/origin/tags &lt;span class="p"&gt;|&lt;/span&gt; 
    cut -d / -f &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read&lt;/span&gt; ref
    &lt;span class="k"&gt;do&lt;/span&gt;
      &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$ref&lt;/span&gt;
      &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
      git tag &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$ref&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;origin/tags/&lt;/span&gt;&lt;span class="nv"&gt;$ref&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      git branch -D &lt;span class="s2"&gt;&amp;quot;origin/tags/&lt;/span&gt;&lt;span class="nv"&gt;$ref&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;done&lt;/span&gt;
    git_pull
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; git_pull&lt;span class="o"&gt;(){&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Push GIT - &lt;/span&gt;&lt;span class="nv"&gt;$REPO_GIT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;---------------------------------------------&amp;quot;&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; ~/&lt;span class="nv"&gt;$PROJECT&lt;/span&gt;.git
    git remote add origin &lt;span class="nv"&gt;$REPO_GIT&lt;/span&gt;
    git push -u origin --all
    git push -u origin --tags
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; main&lt;span class="o"&gt;(){&lt;/span&gt;
    create_dirs
&lt;span class="o"&gt;}&lt;/span&gt;

main
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Sysadmin"></category><category term="svn"></category><category term="git"></category></entry><entry><title>Criando um servidor OpenVPN no CentOS 7</title><link href="https://blog.chcdc.com.br/posts/criando-um-servidor-openvpn-no-centos-7" rel="alternate"></link><published>2019-05-20T00:00:00-03:00</published><updated>2019-05-20T00:00:00-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2019-05-20:/posts/criando-um-servidor-openvpn-no-centos-7</id><summary type="html">&lt;p&gt;OpenVPN √© uma aplica√ß√£o VPN de c√≥digo aberto que permite criar e participar de uma rede privada de forma segura atrav√©s da Internet p√∫blica.&lt;/p&gt;
&lt;p&gt;Vamos instalar e configurar o OpenVPN em um servidor CentOS 7 ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;OpenVPN √© uma aplica√ß√£o VPN de c√≥digo aberto que permite criar e participar de uma rede privada de forma segura atrav√©s da Internet p√∫blica.&lt;/p&gt;
&lt;p&gt;Vamos instalar e configurar o OpenVPN em um servidor CentOS 7.&lt;/p&gt;
&lt;p&gt;Levando em considera√ß√£o que o servidor Linux baseado na distribui√ß√£o CentOS 7 esteja devidamente instalado e com a rede configurada, vamos iniciar a instala√ß√£o.&lt;/p&gt;
&lt;!--more--&gt;
&lt;h3 id="configurando-o-sistema"&gt;Configurando o sistema&lt;/h3&gt;
&lt;p&gt;Desabilite o SELinux&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;sed -i &lt;span class="s1"&gt;&amp;#39;s/^SELINUX=.*/SELINUX=disabled/g&amp;#39;&lt;/span&gt; /etc/sysconfig/selinux &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; cat /etc/sysconfig/selinux 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Desabilite o firewalld&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;systemctl stop firewalld
&lt;span class="gp"&gt;# &lt;/span&gt;systemctl disable firewalld
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ap√≥s as altera√ß√µes reinicie o sistema para aplicar a configura√ß√£o&lt;/p&gt;
&lt;p&gt;Ajuste o kernel para habilitar o modo de roteamento:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; net.ipv4.ip_forward &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &amp;gt;&amp;gt; /etc/sysctl.conf
&lt;span class="gp"&gt;# &lt;/span&gt;sysctl -p
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Atualize o sistema operacional&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;yum upgrade -y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="instalando-openvpn"&gt;Instalando OpenVPN&lt;/h3&gt;
&lt;p&gt;O reposit√≥rio Extra Packages for Enterprise Linux (EPEL) √© um reposit√≥rio adicional gerenciado pelo Projeto Fedora contendo pacotes n√£o padr√£o, mas populares. O OpenVPN n√£o est√° dispon√≠vel nos reposit√≥rios padr√£o do CentOS, mas est√° dispon√≠vel no EPEL, ent√£o instale o EPEL:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;yum install epel-release -y &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; yum update -y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pr√≥ximo passo √© instalar os pacotes necess√°rios&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;yum install openvpn vim -y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Usando o curl, fa√ßa o download do Easy RSA. 
Recomendo o uso do easy-rsa-2, pois h√° mais documenta√ß√£o dispon√≠vel para esta vers√£o. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;curl -L https://github.com/OpenVPN/easy-rsa-old/archive/2.3.3.tar.gz -o /tmp/easyrsa.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Extraia o pacote e crie o diret√≥rio em /etc/openvpn/&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;tar xfz /tmp/easyrsa.tar.gz
&lt;span class="gp"&gt;# &lt;/span&gt;sudo mkdir /etc/openvpn/easy-rsa 
&lt;span class="gp"&gt;# &lt;/span&gt;sudo mkdir /etc/openvpn/keys
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Copie a estrutura do diret√≥rio easy-rsa para o diret√≥rio /etc/openvpn/easy-rsa para facilitar a administra√ß√£o:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;sudo cp -rfv easy-rsa-old-2.3.3/easy-rsa/2.0/* /etc/openvpn/easy-rsa/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Altere o diret√≥rio para um usu√°rio n√£o root&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;chown &lt;span class="s2"&gt;&amp;quot;user&amp;quot;&lt;/span&gt; /etc/openvpn/easy-rsa/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Depois que esses programas forem instalados e tiverem sido movidos para os locais corretos em seu sistema, a pr√≥xima etapa √© personalizar a configura√ß√£o do lado do servidor do OpenVPN.&lt;/p&gt;
&lt;h3 id="configurando-openvpn"&gt;Configurando OpenVPN&lt;/h3&gt;
&lt;p&gt;Temos muitas formas de configurar o OpenVPN, neste documento vamos fazer a forma mais comum de conex√£o.&lt;/p&gt;
&lt;p&gt;Crie o arquivo de configura√ß√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;vim /etc/openvpn/server.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos a Configura√ß√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;IP &lt;span class="k"&gt;do&lt;/span&gt; servidor VPN
&lt;span class="go"&gt;local xxx.xxx.xxx.xxx&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Porta Utilizada
&lt;span class="go"&gt;port 1194&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Protocolo de Conex√£o e porta utilizada
&lt;span class="go"&gt;proto udp &lt;/span&gt;
&lt;span class="go"&gt;dev tun0 &lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Permite que o t√∫nel &lt;span class="k"&gt;continue&lt;/span&gt; aberto mesmo que o endere√ßo IP da outra m√°quina mude
&lt;span class="go"&gt;float&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;&lt;span class="c1"&gt;# Localiza√ß√£o das Chaves e certificados&lt;/span&gt;
&lt;span class="go"&gt;ca /etc/openvpn/keys/ca.crt &lt;/span&gt;
&lt;span class="go"&gt;cert /etc/openvpn/keys/server.crt&lt;/span&gt;
&lt;span class="go"&gt;key /etc/openvpn/keys/server.key  # This file should be kept secret&lt;/span&gt;
&lt;span class="go"&gt;dh /etc/openvpn/keys/dh2048.pem&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Configura o OpenVPN para funcionar como uma 
&lt;span class="gp"&gt;# &lt;/span&gt;sub-rede e informa √† m√°quina cliente qual endere√ßo utilizar
&lt;span class="go"&gt;topology subnet&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Configura√ß√£o &lt;span class="k"&gt;do&lt;/span&gt; endere√ßo &lt;span class="k"&gt;do&lt;/span&gt; servidor
&lt;span class="go"&gt;server 10.1.1.0 255.255.255.0 &lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Configura√ß√£o para manter os endere√ßos est√°ticos dos clientes, 
&lt;span class="gp"&gt;# &lt;/span&gt;caso o OpenVPN reinicie, 
&lt;span class="gp"&gt;# &lt;/span&gt;poder√° ser atribu√≠do aos clientes de reconex√£o o mesmo endere√ßo IP
&lt;span class="go"&gt;ifconfig-pool-persist ipp.txt&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Informa a configura√ß√£o de cada cliente
&lt;span class="go"&gt;client-config-dir /etc/openvpn/ccd/&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Configura√ß√£o para setar o DNS dos clientes, no exemplo abaixo estamos utilizando o opendns.com
&lt;span class="go"&gt;push &amp;quot;dhcp-option DNS 208.67.222.222&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;push &amp;quot;dhcp-option DNS 208.67.220.220&amp;quot;&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Envia um ‚Äúping‚Äù de um lado para o outro, 
&lt;span class="gp"&gt;# &lt;/span&gt;de modo que cada lado saiba quando o outro lado ficou inativo.
&lt;span class="gp"&gt;# &lt;/span&gt;Ping a cada &lt;span class="m"&gt;10&lt;/span&gt; segundos, declara como inativo se nenhum ping &lt;span class="k"&gt;for&lt;/span&gt; recebido 
&lt;span class="gp"&gt;# &lt;/span&gt;durante um tempo de &lt;span class="m"&gt;120&lt;/span&gt; segundos
&lt;span class="go"&gt;keepalive 10 120&lt;/span&gt;


&lt;span class="gp"&gt;# &lt;/span&gt;Chave de seguran√ßa Cipher. Deve conter no arquivo cliente e servidor.
&lt;span class="go"&gt;cipher AES-256-CBC&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Compacta√ß√£o 
&lt;span class="go"&gt;comp-lzo&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Quantidade maxima de clientes 
&lt;span class="go"&gt;max-clients 10&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Op√ß√µes Persistentes
&lt;span class="go"&gt;persist-key&lt;/span&gt;
&lt;span class="go"&gt;persist-tun&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Arquivo de status curto, exibindo as conex√µes atuais, truncadas e reescrito a cada minuto
&lt;span class="go"&gt;status /var/log/openvpn-status.log&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Log OpenVPN
&lt;span class="go"&gt;log-append  /var/log/openvpn.log&lt;/span&gt;
&lt;span class="go"&gt;verb 3&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Notificar o cliente que quando o servidor &lt;span class="k"&gt;for&lt;/span&gt; reiniciado pode reconectar-se automaticamente.
&lt;span class="go"&gt;explicit-exit-notify 1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="gerando-chaves-e-certificados-servidor"&gt;Gerando Chaves e certificados Servidor&lt;/h3&gt;
&lt;p&gt;Come√ßaremos nosso processo de gera√ß√£o de chaves e certificados criando um diret√≥rio no qual o Easy RSA armazenar√° todas as chaves e certificados gerados:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;mkdir /etc/openvpn/easy-rsa/keys
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos editar as vari√°veis padr√µes que ficam no arquivo &lt;strong&gt;vars&lt;/strong&gt; em &lt;strong&gt;/etc/openvpn/easy-rsa/&lt;/strong&gt; :&lt;/p&gt;
&lt;p&gt;V√° at√© o final do arquivo e altere os valores abaixo&lt;/p&gt;
&lt;p&gt;KEY_NAME: O nome do servidor, o mesmo utilizado para a cria√ß√£o das chaves "server.key" e "server.crt"&lt;br /&gt;
export KEY_COUNTRY="BR"&lt;br /&gt;
export KEY_PROVINCE="PR"&lt;br /&gt;
export KEY_CITY="Maringa"&lt;br /&gt;
export KEY_ORG="Empresa"&lt;br /&gt;
export KEY_EMAIL="vpn@company.com.br"&lt;br /&gt;
export KEY_CN=openvpn&lt;br /&gt;
export KEY_NAME="server"&lt;br /&gt;
export KEY_OU="Infraestrutura"&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;Salve e feche o arquivo&lt;/p&gt;
&lt;p&gt;Para come√ßar a gerar as chaves e os certificados, v√° para o diret√≥rio easy-rsa e carregue as vari√°veis declaradas no arquivo vars na mem√≥ria:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa
&lt;span class="gp"&gt;# &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt; ./vars
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Execute o script clean-all do Easy RSA para remover todas as chaves e certificados j√° existentes na pasta e gerar a autoridade de certifica√ß√£o:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;LEMBRE-SE: esse comando remove todas as chaves e certificados j√° criados. N√£o o execute em produ√ß√£o&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;./clean-all
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Este script gera um arquivo chamado ca.key. Essa √© a chave privada usada para assinar seu servidor e os certificados dos clientes. Se estiver perdido, voc√™ n√£o poder√° mais confiar em nenhum certificado dessa autoridade de certifica√ß√£o e, se algu√©m conseguir acessar esse arquivo, poder√° assinar novos certificados e acessar sua VPN sem o seu conhecimento. 
Por esse motivo, o OpenVPN recomenda armazenar o ca.key em um local que possa estar offline o m√°ximo poss√≠vel e s√≥ deve ser ativado ao criar novos certificados.&lt;/p&gt;
&lt;p&gt;Em seguida, construa a autoridade de certifica√ß√£o com o script build-ca. Voc√™ ser√° solicitado a inserir valores para os campos de certificado, mas se voc√™ definir as vari√°veis no arquivo vars anteriormente, todas as suas op√ß√µes j√° estar√£o definidas como padr√µes. Voc√™ pode pressionar ENTER para aceitar os padr√µes de cada um:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;./build-ca
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Gere a chave de criptografia est√°tica com o seguinte comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;openvpn --genkey --secret /etc/openvpn/keys/vpn_server.tlsauth
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Em seguida, crie uma chave e um certificado para o servidor usando o script build-key-server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;./build-key-server server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Assim como na cria√ß√£o da autoridade de certifica√ß√£o, voc√™ ver√° os valores que definiu como padr√£o para poder pressionar ENTER nesses prompts. Al√©m disso, voc√™ ser√° solicitado a inserir uma senha de desafio e um nome de empresa opcional. Se voc√™ digitar uma senha de desafio, voc√™ ser√° solicitado a se conectar √† VPN do seu cliente. Se voc√™ n√£o quiser definir uma senha de desafio, deixe esta linha em branco e pressione ENTER. No final, insira Y para confirmar as altera√ß√µes.&lt;/p&gt;
&lt;p&gt;A √∫ltima parte da cria√ß√£o das chaves e dos certificados do servidor est√° gerando um arquivo de troca de chaves Diffie-Hellman. Use o script build-dh para fazer isso. Isso pode levar alguns minutos para ser conclu√≠do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;./build-dh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Quando o servidor terminar de gerar o arquivo de troca de chaves, copie as chaves do servidor e os certificados do diret√≥rio keys no diret√≥rio openvpn:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa/keys/
&lt;span class="gp"&gt;# &lt;/span&gt;sudo cp dh2048.pem ca.crt server.crt server.key /etc/openvpn/keys
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="gerando-chaves-e-certificados-cliente"&gt;Gerando Chaves e certificados Cliente&lt;/h3&gt;
&lt;p&gt;Cada cliente tamb√©m precisar√° de um certificado para que o servidor OpenVPN possa autentic√°-lo. Essas chaves e certificados ser√£o criados no servidor e voc√™ ter√° que copi√°-los para seus clientes. √â aconselh√°vel gerar chaves e certificados separados para cada cliente que voc√™ pretende conectar √† sua VPN.&lt;/p&gt;
&lt;p&gt;Crie um certificado de cliente teste. N√£o crie um certificado para ser utilizado futuramente, pois o mesmo ser√° utilizado para criar o arquivo de revoga√ß√£o de certificados e ser√° invalidado logo em seguida. Preste aten√ß√£o em alterar o endere√ßo de email para cada certificado novo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa/
&lt;span class="gp"&gt;# &lt;/span&gt;./build-key cert-test
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Revogue o certificado teste, criado anteriormente, para gerar o arquivo crl.pem, que ser√° respons√°vel por controlar os certificados revogados.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;./revoke-full cert-teste
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Sempre que um certificado for revogado, o arquivo crl.pem dever√° ser copiado para a raiz do servidor OpenVPN para que o mesmo possa ser lido:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;cp /etc/openvpn/rsa/keys/crl.pem /etc/openvpn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora vamos criar o certificado, como vamos apenas criar esse, vamos nome√°-lo de client , mas voc√™ pode alterar isso para um nome mais descritivo se quiser:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa/
&lt;span class="gp"&gt;$ &lt;/span&gt;./build-key client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Copie o arquivo de configura√ß√£o do OpenSSL com vers√£o, openssl-1.0.0.cnf, para um nome sem vers√£o, openssl.cnf. N√£o fazer isso pode resultar em um erro em que o OpenSSL n√£o consegue carregar a configura√ß√£o porque n√£o pode detectar sua vers√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;cp /etc/openvpn/easy-rsa/openssl-1.0.0.cnf /etc/openvpn/easy-rsa/openssl.cnf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="iniciando-openvpn"&gt;Iniciando OpenVPN&lt;/h3&gt;
&lt;p&gt;Vamos configurar o OpenVPN para iniciar na inicializa√ß√£o. Para fazer isso, ative o servidor OpenVPN adicionando-o ao systemctl&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;sudo systemctl -f &lt;span class="nb"&gt;enable&lt;/span&gt; openvpn@server.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Inicie o servi√ßo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;sudo systemctl start openvpn@server.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Verifique se n√£o houve erros durante a inicializa√ß√£o do servi√ßo. Caso tenha erros, verifique o arquivo de log /var/log/openvpn.log&lt;/p&gt;
&lt;h3 id="criando-rotas-estaticas"&gt;Criando rotas estaticas&lt;/h3&gt;
&lt;p&gt;Vamos criar para cada cliente uma configura√ß√£o de rede individual&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;mkdir /etc/openvpn/ccd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Dentro do diret√≥rio, crie um arquivo com o nome exatamente igual ao que foi gerado o certificado, no nosso caso √© client&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;touch /etc/openvpn/ccd/client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos inserir as informa√ß√µes necess√°rias.&lt;/p&gt;
&lt;p&gt;[Optional]
Caso deseja que cada cliente tenha um endere√ßo setado manualmente, insira no inicio do arquivo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="go"&gt;ifconfig-push 10.1.1.1 255.255.255.0 &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;[/optional]&lt;/p&gt;
&lt;p&gt;Insira as rotas da rede local e a rede openvpn, caso deseja que ele acesse a mesma&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="go"&gt;push &amp;quot;route 10.1.1.0 255.255.255.0&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;push &amp;quot;route 10.42.12.0 255.255.254.0&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Insira as rotas desejadas, sempre comentando o destino &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;Algum lugar &lt;span class="k"&gt;do&lt;/span&gt; mundo
&lt;span class="go"&gt;push &amp;quot;route 200.200.200.1 255.255.255.0&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="configurando-o-firewall"&gt;Configurando o Firewall&lt;/h3&gt;
&lt;p&gt;Para que o servidor fa√ßa os redirecionamentos necess√°rios e aceite conex√µes precisamos setar isso no iptables&lt;/p&gt;
&lt;p&gt;Execute os seguintes comandos&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gp"&gt;# &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &amp;gt; /proc/sys/net/ipv4/ip_forward
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -P FORWARD ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A INPUT -i tun+ -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A FORWARD -i tun+ -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -t nat -A POSTROUTING -o ens32 -j MASQUERADE
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A FORWARD -i tun0 -o tun0 -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A FORWARD -i tun0 -o ens32 -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A FORWARD -i ens32 -o tun0 -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A INPUT -p tcp --dport &lt;span class="m"&gt;1194&lt;/span&gt; -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -A INPUT -p udp --dport &lt;span class="m"&gt;1194&lt;/span&gt; -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -I INPUT -i tun+ -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -I OUTPUT -o tun+ -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -I FORWARD -i tun+ -j ACCEPT
&lt;span class="gp"&gt;# &lt;/span&gt;iptables -I FORWARD -o tun+ -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="configurando-o-cliente"&gt;Configurando o Cliente&lt;/h3&gt;
&lt;p&gt;Os certificados e chave que ser√£o inseridos no final do arquivo se encontram em /etc/openvpn/easy-rsa/keys/
Sendo eles
    * ca - ca.crt 
    * cert - client.crt
    * key - client.key&lt;/p&gt;
&lt;p&gt;Crie o arquivo client.ovpn com as seguintes configura√ß√µes&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="go"&gt;client&lt;/span&gt;
&lt;span class="go"&gt;pull&lt;/span&gt;
&lt;span class="go"&gt;dev tun&lt;/span&gt;
&lt;span class="go"&gt;proto udp&lt;/span&gt;
&lt;span class="go"&gt;remote &amp;lt;ip external&amp;gt; 1194 udp&lt;/span&gt;
&lt;span class="go"&gt;user nobody&lt;/span&gt;
&lt;span class="go"&gt;group nogroup&lt;/span&gt;
&lt;span class="go"&gt;comp-lzo&lt;/span&gt;
&lt;span class="go"&gt;verb 3&lt;/span&gt;
&lt;span class="go"&gt;resolv-retry infinite&lt;/span&gt;
&lt;span class="go"&gt;persist-key&lt;/span&gt;
&lt;span class="go"&gt;persist-tun&lt;/span&gt;
&lt;span class="go"&gt;mute-replay-warnings&lt;/span&gt;
&lt;span class="go"&gt;auth-nocache&lt;/span&gt;
&lt;span class="go"&gt;float&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Ciphers
&lt;span class="go"&gt;remote-cert-tls server&lt;/span&gt;
&lt;span class="go"&gt;tls-version-min 1.2&lt;/span&gt;
&lt;span class="go"&gt;tls-cipher TLS-DHE-RSA-WITH-AES-256-GCM-SHA384&lt;/span&gt;
&lt;span class="go"&gt;cipher AES-256-CBC&lt;/span&gt;

&lt;span class="gp"&gt;# &lt;/span&gt;Client Keys
&lt;span class="go"&gt;&amp;lt;ca&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;-----BEGIN CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;-----END CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/ca&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;cert&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;-----BEGIN CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;-----END CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/cert&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;key&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;-----BEGIN RSA PRIVATE KEY-----&lt;/span&gt;
&lt;span class="go"&gt;-----END RSA PRIVATE KEY-----&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/key&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Copie o arquivo para sua m√°quina local, pode utilizar sftp ou scp. &lt;/p&gt;
&lt;p&gt;Ap√≥s seguir esses passos, sua vpn dever√° estar j√° criada e acess√≠vel. Realize os testes de acesso, sempre verificando os logs.&lt;/p&gt;
&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;</content><category term="Network"></category><category term="sysadmin"></category><category term="VPN"></category><category term="Linux"></category></entry><entry><title>Dicas IPTables</title><link href="https://blog.chcdc.com.br/posts/dicas-iptables" rel="alternate"></link><published>2018-12-16T19:00:45-02:00</published><updated>2018-12-16T19:00:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-12-16:/posts/dicas-iptables</id><summary type="html">&lt;p&gt;Existem 3 tabelas gerenci√°veis no IPTables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FILTER - esta √© a tabela padr√£o, respons√°vel pela filtragens de pacotes. Possui tr√™s cadeias de conjuntos de regras:&lt;ul&gt;
&lt;li&gt;INPUT - pacotes destinados a sockets locais&lt;/li&gt;
&lt;li&gt;FORWARD - pacotes encaminhados (roteados) atrav√©s ‚Ä¶&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Existem 3 tabelas gerenci√°veis no IPTables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FILTER - esta √© a tabela padr√£o, respons√°vel pela filtragens de pacotes. Possui tr√™s cadeias de conjuntos de regras:&lt;ul&gt;
&lt;li&gt;INPUT - pacotes destinados a sockets locais&lt;/li&gt;
&lt;li&gt;FORWARD - pacotes encaminhados (roteados) atrav√©s do firewall&lt;/li&gt;
&lt;li&gt;OUTPUT - pacotes gerados localmente&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NAT - √© uma tabela que √© consultada quando um pacote tenta criar uma nova conex√£o. Pode alterar caracter√≠sticas de origem ou de destino de um pacote. Possui tr√™s cadeias de conjuntos de regras:&lt;ul&gt;
&lt;li&gt;PREROUTING - utilizado para alterar um pacote, logo que √© recebido&lt;/li&gt;
&lt;li&gt;POSTROUTING - usado para alterar pacotes quando eles est√£o prestes a sair&lt;/li&gt;
&lt;li&gt;OUTPUT - usado para alterar pacotes gerados localmente&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;MANGLE - esta tabela √© usada para altera√ß√£o de pacotes. At√© o kernel vers√£o 2.4 esta tabela tinha apenas 2 cadeias, mas eles s√£o agora 5:&lt;ul&gt;
&lt;li&gt;PREROUTING - para alterar as conex√µes de entrada&lt;/li&gt;
&lt;li&gt;OUTPUT - para alterar pacotes gerados localmente&lt;/li&gt;
&lt;li&gt;INPUT - para pacotes de entrada&lt;/li&gt;
&lt;li&gt;POSTROUTING - para alterar pacotes quando eles est√£o prestes a sair&lt;/li&gt;
&lt;li&gt;FORWARD - pacotes encaminhados (roteados) atrav√©s do firewall&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;1 - Exibir todas as regras dispon√≠veis&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -L -n -v&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Se preferir, verificar apenas uma tabela em espec√≠fico (no caso a tabela nat):&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -t nat -L -n -v&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Ou atrav√©s de linhas numeradas:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -n -L -v --line-numbers&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2 - Bloquear endere√ßo IP espec√≠fico entrante na rede&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Para adicionar regra:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -s xxx.xxx.xxx.xxx -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Para remov√™-la:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -D INPUT -s xxx.xxx.xxx.xxx -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3 - Bloquear porta espec√≠fica&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Sainte:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A OUTPUT -p tcp --dport xxx -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Entrante:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp --dport xxx -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Ou m√∫ltiplas portas:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT  -p tcp -m multiport --dports 22,80,443 -j ACCEPT&lt;/code&gt;
&lt;code&gt;iptables -A OUTPUT -p tcp -m multiport --sports 22,80,443 -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4 - Permitir rede espec√≠fica acessar determinada porta:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A OUTPUT -p tcp -d 192.168.100.0/24 --dport  -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5 - Bloquear Network Flood sobre o servidor web que esteja escutando na porta 80&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Aceitando de 100 a 200 conex√µes por minuto (ajuste da maneira que achar melhor):&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp --dport  -m limit --limit 100/minute --limit-burst  -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;6 - Manter registros de Log‚Äôs de pacotes bloqueados:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -i eth0 -j LOG --log-prefix "Quantidade pacotes bloqueados:"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp -dport  -j LOG -log-prefix ‚ÄúServi√ßo: ftp‚Äù&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Os log‚Äôs s√£o salvos em /var/log/messages. Onde voc√™ poder√° filtrar usando comando grep:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;grep "Quantidade pacotes bloqueados:" /var/log/messages&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;7 -Limitar o n√∫mero de conex√µes simult√¢neas oriundas de determinado IP:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp --syn --dport  -m connlimit --connlimit-above  -j REJECT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Onde, essa regra permitir√° 3 conex√µes simult√¢neas advindas de um mesmo endere√ßo IP na porta 22 (SSH).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;8 - Permitir conex√µes j√° estabelecidas:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9 - Bloquear Ping Requests:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p icmp -icmp-type echo-request -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;10 - Bloquear por endere√ßo MAC:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -m mac --mac-source 00:00:00:00:00:00 -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Simples assim! üòÜ&lt;/p&gt;</content><category term="Linux"></category><category term="Network"></category><category term="Sysadmin"></category></entry><entry><title>Criando VPN IPSec com StrongSwan entre Digital Ocean e AWS</title><link href="https://blog.chcdc.com.br/posts/criando-vpn-ipsec-com-strongswan-entre-digital-ocean-e-aws" rel="alternate"></link><published>2018-09-18T20:45:15-02:00</published><updated>2018-09-18T20:45:15-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-09-18:/posts/criando-vpn-ipsec-com-strongswan-entre-digital-ocean-e-aws</id><summary type="html">&lt;p&gt;Conforme mostrei nesse &lt;a href="https://blog.chcdc.com.br/posts/vpn-ipsec/"&gt;post&lt;/a&gt; vamos agora configurar uma VPN IPSec.&lt;/p&gt;
&lt;p&gt;Vamos utilizar o &lt;a href="https://www.strongswan.org/"&gt;StrongSwan&lt;/a&gt; para configurarmos a VPN IPSec. &lt;/p&gt;
&lt;p&gt;Os peers ser√£o configurados em dois ambientes distintos, Digital Ocean e AWS.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;A instala√ß√£o ser√° feita ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Conforme mostrei nesse &lt;a href="https://blog.chcdc.com.br/posts/vpn-ipsec/"&gt;post&lt;/a&gt; vamos agora configurar uma VPN IPSec.&lt;/p&gt;
&lt;p&gt;Vamos utilizar o &lt;a href="https://www.strongswan.org/"&gt;StrongSwan&lt;/a&gt; para configurarmos a VPN IPSec. &lt;/p&gt;
&lt;p&gt;Os peers ser√£o configurados em dois ambientes distintos, Digital Ocean e AWS.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;A instala√ß√£o ser√° feita na distribui√ß√£o CentOS 7.5.1804x64.&lt;/p&gt;
&lt;p&gt;Para o ambiente amazon foi utilizado a inst√¢ncia Amazon Linux 2 AMI &lt;/p&gt;
&lt;p&gt;A VPN Site to Site precisa ser configurada dos dois lados, por isso, vamos configurar primeiro o servidor da esquerda (left) que ser√° a Digital Ocean.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Desabilitar SeLinux&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# sed -i &amp;#39;s/^SELINUX=.*/SELINUX=disabled/g&amp;#39; /etc/sysconfig/selinux &amp;amp;&amp;amp; cat /etc/sysconfig/selinux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Atualizar o Sistema&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# yum -y update&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Reiniciar para aplicar as altera√ß√µes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# reboot&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Instale os pacotes necess√°rios&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;#  yum install -y vim epel-release&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Para a instala√ß√£o do lado amazon, vamos utilizar os reposit√≥rios Amazon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@peer-aws  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# amazon-linux-extras install epel -y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Nesse caso, foi utilizado a √∫ltima vers√£o do pacote StrongSwan. Vers√£o 5.6.3&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# yum install strongswan -y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Arquivo de configura√ß√£o lado esquerdo (left)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.conf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;config&lt;/span&gt; &lt;span class="n"&gt;setup&lt;/span&gt;
    &lt;span class="n"&gt;charondebug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;all&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;uniqueids&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;yes&lt;/span&gt;
    &lt;span class="n"&gt;strictcrlpolicy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;no&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;
    &lt;span class="n"&gt;ikelifetime&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;
    &lt;span class="n"&gt;mobike&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;yes&lt;/span&gt;
    &lt;span class="n"&gt;ike&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;aes128&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;sha1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;modp1536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;des&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;sha1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;modp3072&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
    &lt;span class="n"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;aes128&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;sha1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;modp1536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;des&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;sha1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;modp3072&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;

&lt;span class="c1"&gt;# Nome a ser utilizado para a conexao &lt;/span&gt;
&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="n"&gt;left&lt;/span&gt;

    &lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;
    &lt;span class="n"&gt;leftsubnet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;10.46&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;
    &lt;span class="n"&gt;leftid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;
    &lt;span class="n"&gt;leftfirewall&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;yes&lt;/span&gt;

    &lt;span class="c1"&gt;# Outra Ponta&lt;/span&gt;
    &lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt; 
    &lt;span class="n"&gt;rightsubnet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;172.31&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;13.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;
    &lt;span class="n"&gt;rightid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xxx&lt;/span&gt;

    &lt;span class="c1"&gt;# Fechar a VPN automaticamente&lt;/span&gt;
    &lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;
    &lt;span class="c1"&gt;# Ativar o Tunel , necessario quando existe NAT&lt;/span&gt;
    &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;tunnel&lt;/span&gt;
    &lt;span class="c1"&gt;# Compressao&lt;/span&gt;
    &lt;span class="n"&gt;compress&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;yes&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Gerando a chave secret para usar em ambos os lados
Existem N formas de gerar uma chave/password, nesse caso vamos utilizar o seguinte comando:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# date +%s | sha256sum | base64 | head -c 32 ; echo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O resultado apresentado foi:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;YmYyMzhiY2EwZWZjOGIzNzJiYjhkODRj&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Vamos editar o arquivo secrets&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.secrets&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# ipsec.secrets - strongSwan IPsec secrets file&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;IP lado direito&amp;gt; : &amp;lt;Criptografia Usada&amp;gt; ‚Äú&amp;lt;Chave&amp;gt;‚Äù&lt;/span&gt;
xxx.xx.xx.xxx : PSK &lt;span class="s2"&gt;&amp;quot;YmYyMzhiY2EwZWZjOGIzNzJiYjhkODRj&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Setando strongswan para iniciar com o sistema / Iniciar strongswan&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl enable strongswan&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Ap√≥s a configura√ß√£o do left vamos iniciar o strongswan e partir para configurar o right.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl start strongswan&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="configurando-lado-direito-right"&gt;Configurando lado direito (right)&lt;/h3&gt;
&lt;p&gt;Vamos partir do princ√≠pio que os passos 1 ao 4 j√° foram executados. Vamos configurar o nosso lado direito que no nosso caso √© a AWS&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arquivo de configura√ß√£o do lado direito (right)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.conf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;No caso da Amazon, temos que configurar o endere√ßo left com o IP da rede local, e o leftid com o IP externo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;config setup
        &lt;span class="nv"&gt;charondebug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;all&amp;quot;&lt;/span&gt;
        &lt;span class="nv"&gt;uniqueids&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes
        &lt;span class="nv"&gt;strictcrlpolicy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;no

&lt;span class="c1"&gt;# Preferencias padroes para todas as conexoes&lt;/span&gt;
conn %default
        &lt;span class="nv"&gt;ikelifetime&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60m
        &lt;span class="nv"&gt;mobike&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes
        &lt;span class="nv"&gt;ike&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;aes128-sha1-modp1536,3des-sha1-modp3072!
        &lt;span class="nv"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;aes128-sha1-modp1536,3des-sha1-modp3072!

conn right
    &lt;span class="nv"&gt;left&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xxx.xx.xx.xxx
    &lt;span class="nv"&gt;leftsubnet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;172&lt;/span&gt;.31.13.0/20
    &lt;span class="nv"&gt;leftid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xxx.xxx.xx.xx
    &lt;span class="nv"&gt;leftfirewall&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes

    &lt;span class="nv"&gt;right&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xx.xx.xxx.xxx
    &lt;span class="nv"&gt;rightsubnet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;.46.0.0/16
    &lt;span class="nv"&gt;rightid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xx.xx.xxx.xxx
    &lt;span class="nv"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;start
    &lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;tunnel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Vamos configurar o secret&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.secrets&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Vamos inserir a mesma chave setada no left&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# ipsec.secrets - strongSwan IPsec secrets file&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;IP lado direito&amp;gt; : &amp;lt;Criptografia Usada&amp;gt; ‚Äú&amp;lt;Chave&amp;gt;‚Äù&lt;/span&gt;
xxx.xx.xxx.xxx : PSK &lt;span class="s2"&gt;&amp;quot;YmYyMzhiY2EwZWZjOGIzNzJiYjhkODRj&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Setando para iniciar com o sistema / iniciando o servi√ßo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl enable strongswan&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl start strongswan&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
&lt;li&gt;Verificando conex√µes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lado Digital Ocean&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# strongswan status left&lt;/span&gt;

Security Associations &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt; up, &lt;span class="m"&gt;0&lt;/span&gt; connecting&lt;span class="o"&gt;)&lt;/span&gt;:
         left&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;: ESTABLISHED &lt;span class="m"&gt;2&lt;/span&gt; minutes ago, xx.xx.xxx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xx.xx.xxx.xxx&lt;span class="o"&gt;]&lt;/span&gt;...xx.xxx.xxx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xx.xx.xxx.xxx&lt;span class="o"&gt;]&lt;/span&gt;
         left&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:  INSTALLED, TUNNEL, reqid &lt;span class="m"&gt;4&lt;/span&gt;, ESP &lt;span class="k"&gt;in&lt;/span&gt; UDP SPIs: ca942554_i ce718f43_o
         left&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:   &lt;span class="m"&gt;10&lt;/span&gt;.46.0.0/16 &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="m"&gt;172&lt;/span&gt;.31.0.0/20
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Lado AWS&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# strongswan status right&lt;/span&gt;

Security Associations &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; up, &lt;span class="m"&gt;0&lt;/span&gt; connecting&lt;span class="o"&gt;)&lt;/span&gt;:
right&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;: ESTABLISHED &lt;span class="m"&gt;3&lt;/span&gt; minutes ago, xxx.xx.xx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xx.xxx.xxx.xxx&lt;span class="o"&gt;]&lt;/span&gt;...xxx.xx.xx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xxx.xx.xx.xxx&lt;span class="o"&gt;]&lt;/span&gt;
right&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:  INSTALLED, TUNNEL, reqid &lt;span class="m"&gt;1&lt;/span&gt;, ESP &lt;span class="k"&gt;in&lt;/span&gt; UDP SPIs: ce718f43_i ca942554_o
right&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:   &lt;span class="m"&gt;172&lt;/span&gt;.31.0.0/20 &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;.46.0.0/16
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Simples Assim :)&lt;/p&gt;</content><category term="Linux"></category><category term="IPSec"></category><category term="VPN"></category></entry><entry><title>VPN IPSec</title><link href="https://blog.chcdc.com.br/posts/vpn-ipsec" rel="alternate"></link><published>2018-09-15T01:59:44-02:00</published><updated>2018-09-15T01:59:44-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-09-15:/posts/vpn-ipsec</id><summary type="html">&lt;p&gt;√â um conjunto de protocolos que oferece uma seguran√ßa no nivel de camada IP. Sendo assim opera pela camada de rede (camada 3) do modelo OSI e modelo TCP/IP.&lt;/p&gt;
&lt;p&gt;O IPsec pode ser usado ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;√â um conjunto de protocolos que oferece uma seguran√ßa no nivel de camada IP. Sendo assim opera pela camada de rede (camada 3) do modelo OSI e modelo TCP/IP.&lt;/p&gt;
&lt;p&gt;O IPsec pode ser usado para proteger dados de rede, por exemplo, configurando circuitos usando o encapsulamento IPsec, no qual todos os dados enviados entre dois pontos de extremidade s√£o criptografados, como em uma conex√£o VPN ( Rede Virtual Privada ); para criptografar dados da camada de aplicativo ; e para fornecer seguran√ßa aos roteadores que enviam dados de roteamento pela Internet p√∫blica. O IPsec tamb√©m pode ser usado para fornecer autentica√ß√£o sem criptografia, por exemplo, para autenticar os dados originados de um remetente conhecido.&lt;/p&gt;
&lt;p&gt;O tr√°fego da Internet pode ser protegido de host para host sem o uso de IPsec, por exemplo, por criptografia na camada de aplicativo (Camada 7 do modelo OSI ) com HTTP Seguro (HTTPS) ou na camada de transporte (Camada 4 do modelo OSI) com o protocolo TLS ( Transport Layer Security ). No entanto, quando o tr√°fego usa criptografia ou autentica√ß√£o nessas camadas superiores, os agentes de amea√ßa ainda podem interceptar informa√ß√µes de protocolo que podem expor dados que devem ser criptografados. &lt;/p&gt;
&lt;p&gt;Pode usar criptografia para fornecer seguran√ßa. O IPsec pode ser usado para a configura√ß√£o de redes privadas virtuais (VPNs) de maneira segura.&lt;/p&gt;
&lt;!--more--&gt;
&lt;h3 id="protocolos-ipsec"&gt;Protocolos IPSec&lt;/h3&gt;
&lt;p&gt;O IPsec √© definido para uso com as duas vers√µes atuais do Internet Protocol, IPv4 e IPv6, sendo obrigatorio em IPv6. Os cabe√ßalhos do protocolo IPsec s√£o inclu√≠dos no cabe√ßalho IP, onde aparecem como extens√µes de cabe√ßalho IP quando um sistema est√° usando IPsec.&lt;/p&gt;
&lt;p&gt;Os protocolos mais importantes considerados como parte do IPsec incluem:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;O Cabe√ßalho de Autentica√ß√£o de IP (AH), especificado no &lt;a href="https://tools.ietf.org/html/rfc4302"&gt;RFC 4302&lt;/a&gt;, define um cabe√ßalho de pacote opcional a ser usado para garantir a integridade sem conex√£o e a autentica√ß√£o de origem de dados para pacotes IP e para proteger contra replays.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;O IP Encapsulating Security Payload (ESP), especificado no &lt;a href="https://www.ietf.org/rfc/rfc4303.txt"&gt;RFC 4303&lt;/a&gt;, define um cabe√ßalho de pacote opcional que pode ser usado para fornecer confidencialidade atrav√©s de criptografia do pacote, bem como prote√ß√£o de integridade, autentica√ß√£o de origem de dados, controle de acesso e prote√ß√£o opcional contra replays ou an√°lise de tr√°fego.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;O IKE (Internet Key Exchange), definido no &lt;a href="https://tools.ietf.org/html/rfc7296"&gt;RFC 7296&lt;/a&gt;, "IKEv2 (Internet Key Exchange Protocol Version 2)", √© um protocolo definido para permitir que os hosts especifiquem quais servi√ßos devem ser incorporados nos pacotes, algoritmos criptogr√°ficos que ser√£o usados ‚Äã‚Äãpara fornecer esses servi√ßos e um mecanismo para compartilhar as chaves usadas com esses algoritmos criptogr√°ficos. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="fases-ipsec"&gt;Fases IPSec&lt;/h3&gt;
&lt;p&gt;O IPSec envolve muitas tecnologias de componentes e m√©todos de criptografia. No entanto, a opera√ß√£o do IPSec pode ser dividida em cinco etapas principais:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;"Interesting traffic"&lt;/strong&gt; Inicia o processo IPSec. O tr√°fego √© considerado interessante quando a pol√≠tica de seguran√ßa IPSec configurada nos pares IPSec inicia o processo IKE.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Fase IKE 1.&lt;/strong&gt;  O IKE autentica os pares IPSec e negocia os IKEs SA durante essa fase, configurando um canal seguro para negociar as SAs IPSec na fase 2.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Fase IKE 2.&lt;/strong&gt; IKE negocia os par√¢metros IPSec SA e configura as SAs IPSec correspondentes nos pares.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Transfer√™ncia de dados.&lt;/strong&gt; Os dados s√£o transferidos entre os pares IPSec com base nos par√¢metros IPSec e nas chaves armazenadas no banco de dados SA.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Termina√ß√£o de t√∫nel IPSec.&lt;/strong&gt; IPSec SAs terminam por exclus√£o ou por tempo limite.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="implementando-o-ipsec"&gt;Implementando o IPsec&lt;/h3&gt;
&lt;p&gt;O suporte a IPsec foi geralmente inclu√≠do na maioria dos sistemas operacionais comuns (e outros) dispon√≠veis desde o final dos anos 90, incluindo sistemas operacionais de desktop e servidor, bem como roteadores e outros dispositivos de seguran√ßa de rede.&lt;/p&gt;
&lt;p&gt;Embora os sistemas mais antigos possam suportar alguma vers√£o do IPsec, as empresas devem implantar o IPsec usando sistemas operacionais atualizados e atualizados em patches de seguran√ßa. Al√©m disso, sistemas mais antigos que suportam vers√µes mais antigas do IPsec e parecem ativar circuitos IPsec seguros podem, na verdade, n√£o manter os dados seguros. &lt;/p&gt;
&lt;p&gt;Nos proximos posts vamos configurar e implementar uma VPN IPSec.&lt;/p&gt;
&lt;hr&gt;
&lt;h5 id="fontes"&gt;Fontes:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc4302"&gt;RFC 4302&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.ietf.org/rfc/rfc4303.txt"&gt;RFC 4303&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc7296"&gt;RFC 7296&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.ciscopress.com/articles/article.asp?p=25474&amp;amp;seqNum=7"&gt;Cisco Press&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Linux"></category><category term="IPSec"></category><category term="VPN"></category></entry><entry><title>Entendendo as Permiss√µes no Linux</title><link href="https://blog.chcdc.com.br/posts/entendendo-as-permissoes-no-linux" rel="alternate"></link><published>2018-02-27T09:23:45-02:00</published><updated>2018-02-27T09:23:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-02-27:/posts/entendendo-as-permissoes-no-linux</id><summary type="html">&lt;p&gt;As permiss√µes s√£o usadas para definir quem pode acessar determinados arquivos ou diret√≥rios, assim mantendo seguran√ßa e organiza√ß√£o em seu sistema e sua rede. &lt;/p&gt;
&lt;p&gt;Quando, em um sistema (li)Unix digitamos o comando &lt;code&gt;ls -l ‚Ä¶&lt;/code&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;As permiss√µes s√£o usadas para definir quem pode acessar determinados arquivos ou diret√≥rios, assim mantendo seguran√ßa e organiza√ß√£o em seu sistema e sua rede. &lt;/p&gt;
&lt;p&gt;Quando, em um sistema (li)Unix digitamos o comando &lt;code&gt;ls -l&lt;/code&gt; temos a seguinte visualiza√ß√£o:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ls -l" src="/images/ls_l.png"&gt;&lt;/p&gt;
&lt;p&gt;Vemos o primeiro item em cada linha √© a forma utilizada para mostrar as permissoes do arquivo.
O Linux trata todos os diret√≥rios como arquivos tamb√©m, portanto, as permiss√µes se aplicam de igual forma para ambos.&lt;/p&gt;
&lt;p&gt;O primeiro caractere aparece para indicar o tipo de arquivo:&lt;/p&gt;
&lt;p&gt;d =&amp;gt; diret√≥rio&lt;br&gt;
b =&amp;gt; arquivo de bloco&lt;br&gt;
c =&amp;gt; arquivo especial de caractere&lt;br&gt;
p =&amp;gt; canal&lt;br&gt;
s =&amp;gt; socket&lt;br&gt;
- =&amp;gt; arquivo "normal"  &lt;/p&gt;
&lt;p&gt;As permiss√µes v√£o definidas assim:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(r) Leitura&lt;/li&gt;
&lt;li&gt;(w) Escrita&lt;/li&gt;
&lt;li&gt;(x) Execu√ß√£o&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Como as permiss√µes s√£o divididas em 3, ir√° aparecer assim: &lt;/p&gt;
&lt;p&gt;(rwx)(rwx)(rwx) &lt;/p&gt;
&lt;p&gt;Tipo de permiss√£o Octal:&lt;br&gt;
4 - Indica permiss√£o de leitura;&lt;br&gt;
2 - Permiss√£o de escrita;&lt;br&gt;
1 - Indica permiss√£o de execu√ß√£o;&lt;br&gt;
0 - Indica sem permiss√µes.  &lt;/p&gt;
&lt;p&gt;Ent√£o a libera√ß√µes podem ser definidas somando as permiss√µes em octal, fazendo da seguinte forma:&lt;br&gt;
 4 + 2 + 1 = 7 (permiss√£o de rwx - Leitura, escrita e execu√ß√£o)&lt;br&gt;
 4 + 2 = 6     (permiss√£o rw - Leitura e escrita)&lt;br&gt;
 4 =           (permiss√£o r - Apenas Leitura)  &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;Usu√°rio&lt;/th&gt;
&lt;th align="center"&gt;Grupo&lt;/th&gt;
&lt;th align="center"&gt;Outros usu√°rios (n√£o donos)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;0&lt;/td&gt;
&lt;td align="center"&gt;0&lt;/td&gt;
&lt;td align="center"&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Leitura=negada&lt;/td&gt;
&lt;td align="center"&gt;Leitura=negada&lt;/td&gt;
&lt;td align="center"&gt;Leitura=negada&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Escrita=negada&lt;/td&gt;
&lt;td align="center"&gt;Escrita=negada&lt;/td&gt;
&lt;td align="center"&gt;Escrita=negada&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Execu√ß√£o=negada&lt;/td&gt;
&lt;td align="center"&gt;Execu√ß√£o=negada&lt;/td&gt;
&lt;td align="center"&gt;Execu√ß√£o=negada&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Simples Assim üòÉ&lt;/p&gt;</content><category term="Linux"></category><category term="Sysadmin"></category></entry><entry><title>Copiando arquivos com Python</title><link href="https://blog.chcdc.com.br/posts/copiando-arquivos-com-python" rel="alternate"></link><published>2018-02-14T10:55:25-02:00</published><updated>2018-02-14T10:55:25-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-02-14:/posts/copiando-arquivos-com-python</id><summary type="html">&lt;p&gt;Nesse &lt;a href="chcdc.com.br/posts/enviar-emails-com-python"&gt;post&lt;/a&gt; ensinei a criar um script basico para o envio de emails usando python.&lt;/p&gt;
&lt;p&gt;Vamos agora aprender a coletar os logs (ou arquivos que voce desejar) para anexar ao script de envio de emails ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nesse &lt;a href="chcdc.com.br/posts/enviar-emails-com-python"&gt;post&lt;/a&gt; ensinei a criar um script basico para o envio de emails usando python.&lt;/p&gt;
&lt;p&gt;Vamos agora aprender a coletar os logs (ou arquivos que voce desejar) para anexar ao script de envio de emails.&lt;/p&gt;
&lt;p&gt;Lembrando que a vers√£o do Python que iremos trabalhar √© a &lt;strong&gt;3.6&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Antes de tudo vamos instalar o modulo &lt;a href="http://docs.paramiko.org/en/2.4/"&gt;Paramiko&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ pip3.6 install paramiko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos inserir os modulos&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Come√ßamos importando os modulos necessarios para acessar e copiar os arquivos.
Os modulos que vamos utilizar s√£o &lt;a href="http://docs.paramiko.org/en/2.4/"&gt;Paramiko&lt;/a&gt; e o &lt;a href="https://docs.python.org/3.6/library/shutil.html"&gt;shutil&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Esse ultimo n√£o ser√° necessario a instala√ß√£o pois √© um dos modulos padr√µes do Python&lt;/p&gt;
&lt;p&gt;Inicialmente vamos abrir a conex√£o com servidor, passando por parametros as informa√ß√µes do host&lt;/p&gt;
&lt;p&gt;Podemos ver que usamos a porta padr√£o, porem n√£o esque√ßa de alterar caso seja diferente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;copyFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Abre a conex√£o&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSHClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Insere a chave do servidor remoto como confiavel&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_missing_host_key_policy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AutoAddPolicy&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="c1"&gt;# Carrega as chaves j√° inseridas&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_system_host_keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Efetua a conex√£o pela porta 22 com o usuario USER&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora vamos setar as vari√°veis, inserindo quais arquivos copiar&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    # &lt;span class="nv"&gt;Nome&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="nv"&gt;arquivo&lt;/span&gt; &lt;span class="nv"&gt;a&lt;/span&gt; &lt;span class="nv"&gt;ser&lt;/span&gt; &lt;span class="nv"&gt;copiado&lt;/span&gt;
    &lt;span class="nv"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; [&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;NAME OF FILE&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;]
    # &lt;span class="nv"&gt;Caminho&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; &lt;span class="nv"&gt;arquivo&lt;/span&gt;, &lt;span class="nv"&gt;podemos&lt;/span&gt; &lt;span class="nv"&gt;setar&lt;/span&gt; &lt;span class="nv"&gt;diversos&lt;/span&gt; &lt;span class="nv"&gt;locais&lt;/span&gt;
    &lt;span class="nv"&gt;remote_images_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;/path/remote/of/file/&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
    # &lt;span class="nv"&gt;Caminho&lt;/span&gt; &lt;span class="nv"&gt;onde&lt;/span&gt; &lt;span class="nv"&gt;sera&lt;/span&gt; &lt;span class="nv"&gt;salvo&lt;/span&gt; &lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;arquivo&lt;/span&gt;
    &lt;span class="nv"&gt;local_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt;/path/local/of/destiny/&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos precisar de um &lt;code&gt;for&lt;/code&gt; para copiar os arquivo(s)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    # &lt;span class="nv"&gt;Abre&lt;/span&gt; &lt;span class="nv"&gt;a&lt;/span&gt; &lt;span class="nv"&gt;conex&lt;/span&gt;√¢&lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;ftp&lt;/span&gt;
    &lt;span class="nv"&gt;sftp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt;.&lt;span class="nv"&gt;open_sftp&lt;/span&gt;&lt;span class="ss"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt; &lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;files&lt;/span&gt;:
        # &lt;span class="nv"&gt;Aqui&lt;/span&gt; &lt;span class="nv"&gt;setamos&lt;/span&gt; &lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;caminho&lt;/span&gt; &lt;span class="nv"&gt;e&lt;/span&gt; &lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;arquivo&lt;/span&gt; &lt;span class="nv"&gt;a&lt;/span&gt; &lt;span class="nv"&gt;ser&lt;/span&gt; &lt;span class="nv"&gt;copiado&lt;/span&gt;
        &lt;span class="nv"&gt;file_remote&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;remote_images_path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt;
        # &lt;span class="nv"&gt;Aqui&lt;/span&gt; &lt;span class="nv"&gt;setamos&lt;/span&gt; &lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;caminho&lt;/span&gt; &lt;span class="nv"&gt;local&lt;/span&gt;
        &lt;span class="nv"&gt;file_local&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;local_path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt;

        # &lt;span class="nv"&gt;Exibe&lt;/span&gt; &lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;caminho&lt;/span&gt; &lt;span class="nv"&gt;remoto&lt;/span&gt; &lt;span class="nv"&gt;sendo&lt;/span&gt; &lt;span class="nv"&gt;copiado&lt;/span&gt; &lt;span class="nv"&gt;para&lt;/span&gt; &lt;span class="nv"&gt;o&lt;/span&gt; &lt;span class="nv"&gt;caminho&lt;/span&gt; &lt;span class="nv"&gt;local&lt;/span&gt;
        &lt;span class="nv"&gt;print&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;file_remote&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="s"&gt; &amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nv"&gt;file_local&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
        # &lt;span class="nv"&gt;Efetua&lt;/span&gt; &lt;span class="nv"&gt;a&lt;/span&gt; &lt;span class="nv"&gt;copia&lt;/span&gt;
        &lt;span class="nv"&gt;sftp&lt;/span&gt;.&lt;span class="nv"&gt;get&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;file_remote&lt;/span&gt;, &lt;span class="nv"&gt;file_local&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;

        # &lt;span class="nv"&gt;Fecha&lt;/span&gt; &lt;span class="nv"&gt;as&lt;/span&gt; &lt;span class="nv"&gt;conex&lt;/span&gt;√µ&lt;span class="nv"&gt;es&lt;/span&gt;
        &lt;span class="nv"&gt;sftp&lt;/span&gt;.&lt;span class="nv"&gt;close&lt;/span&gt;&lt;span class="ss"&gt;()&lt;/span&gt;
        &lt;span class="nv"&gt;s&lt;/span&gt;.&lt;span class="nv"&gt;close&lt;/span&gt;&lt;span class="ss"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h6 id="o-script-final-ficara-dessa-forma"&gt;O script final ficar√° dessa forma&lt;/h6&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;copyFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Abre a conex√£o&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSHClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Insere a chave do servidor remoto como confiavel&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_missing_host_key_policy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AutoAddPolicy&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="c1"&gt;# Carrega as chaves j√° inseridas&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_system_host_keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Efetua a conex√£o pela porta 22 com o usuario USER&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Nome do arquivo a ser copiado&lt;/span&gt;
    &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NAME OF FILE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# Caminho do arquivo, podemos setar diversos locais&lt;/span&gt;
    &lt;span class="n"&gt;remote_images_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/path/remote/of/file/&amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;# Caminho onde sera salvo o arquivo&lt;/span&gt;
    &lt;span class="n"&gt;local_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/path/local/of/destiny/&amp;#39;&lt;/span&gt;

    &lt;span class="c1"&gt;# Abre a conex√£o ftp&lt;/span&gt;
    &lt;span class="n"&gt;sftp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open_sftp&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# Aqui setamos o caminho e o arquivo a ser copiado&lt;/span&gt;
        &lt;span class="n"&gt;file_remote&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;remote_images_path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;
        &lt;span class="c1"&gt;# Aqui setamos o caminho local&lt;/span&gt;
        &lt;span class="n"&gt;file_local&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;

        &lt;span class="c1"&gt;# Exibe o caminho remoto sendo copiado para o caminho local&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_remote&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;gt;&amp;gt;&amp;gt;&amp;#39;&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;file_local&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# Efetua a copia&lt;/span&gt;
        &lt;span class="n"&gt;sftp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_remote&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_local&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# Fecha as conex√µes&lt;/span&gt;
        &lt;span class="n"&gt;sftp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;
&lt;p&gt;Qualquer duvida ou algo pra complementar deixe seu comentario.&lt;/p&gt;
&lt;p&gt;Fontes:&lt;/p&gt;
&lt;p&gt;‚Äì http://docs.paramiko.org/en/2.4/&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3.6/library/shutil.html&lt;/p&gt;</content><category term="Python"></category><category term="script"></category></entry><entry><title>Enviar emails com Python</title><link href="https://blog.chcdc.com.br/posts/enviar-emails-com-python" rel="alternate"></link><published>2018-02-09T02:10:18-02:00</published><updated>2018-02-09T02:10:18-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-02-09:/posts/enviar-emails-com-python</id><summary type="html">&lt;p&gt;Hoje me foi proposto um desafio, coletar logs de um servidor via Telegram e enviar por email.&lt;/p&gt;
&lt;p&gt;Ap√≥s algumas horas em pesquisa, cheguei ao seguinte script que vou ensinar mais abaixo, primeiramente vamos fazer
o ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Hoje me foi proposto um desafio, coletar logs de um servidor via Telegram e enviar por email.&lt;/p&gt;
&lt;p&gt;Ap√≥s algumas horas em pesquisa, cheguei ao seguinte script que vou ensinar mais abaixo, primeiramente vamos fazer
o script de envio de emails.&lt;/p&gt;
&lt;p&gt;Antes de tudo, caso use GMail, voc√™ precisa permitir "aplicativos menos seguros" para executar seu script.&lt;/p&gt;
&lt;p&gt;A vers√£o do Python que iremos trabalhar √© a &lt;strong&gt;3.6&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Vamos come√ßar com um script simples,
existe uma biblioteca nativa em Python para enviar e-mails: smtplib. N√£o ser√° necess√°rio instalar bibliotecas externas!&lt;/p&gt;
&lt;p&gt;Para enviar um email b√°sico (sem linha de assunto), com um endere√ßo do Gmail, o c√≥digo √© bastante simples:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;smtp.gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;587&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starttls&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SEU EMAIL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA SENHA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MENSAGEM!&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SEU EMAIL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;EMAIL DESTINO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Na linha 2, s√£o os par√¢metros para o servidor Gmail.
Primeiro, a localiza√ß√£o do servidor (ou endere√ßo IP), ent√£o a porta a ser usada.&lt;/p&gt;
&lt;p&gt;Na linha 3, h√° uma fun√ß√£o de seguran√ßa, necess√°ria para se conectar ao servidor do Gmail.
Ele proteger√° sua senha.&lt;/p&gt;
&lt;p&gt;N√£o podemos esquecer o endere√ßo de e-mail e senha na linha 4.&lt;/p&gt;
&lt;p&gt;A vari√°vel &lt;code&gt;msg&lt;/code&gt; conter√° sua mensagem e a linha 7 ir√° envi√°-la!&lt;/p&gt;
&lt;h2 id="para-um-email-mais-elaborado"&gt;Para um email mais elaborado&lt;/h2&gt;
&lt;p&gt;Aqui j√° estamos inserindo alguns dados, como assunto, rementente.&lt;/p&gt;
&lt;p&gt;Para isso precisamos de mais modulos, j√° disponiveis na biblioteca basica do Python,
o &lt;strong&gt;&lt;em&gt;email.mime.multipart&lt;/em&gt;&lt;/strong&gt; e o &lt;strong&gt;&lt;em&gt;email.mime.text&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.multipart&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;
&lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.text&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;
&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt;  &lt;span class="n"&gt;fromaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SEU ENDERE√áO&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;7&lt;/span&gt;  &lt;span class="n"&gt;toaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ENDERE√áO DE DESTINO&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt;  &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;9&lt;/span&gt;  &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;From&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fromaddr&lt;/span&gt;
&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;To&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;
&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Subject&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ASSUNTO&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;12&lt;/span&gt;
&lt;span class="mi"&gt;13&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA MENSAGEM AQUI&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;14&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="mi"&gt;15&lt;/span&gt;
&lt;span class="mi"&gt;16&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;smtp.gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;587&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;17&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starttls&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;18&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA SENHA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;19&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_string&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;21&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;N√£o esque√ßa de alterar as seguinte linhas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Linha 6 Com seu endere√ßo de email&lt;/li&gt;
&lt;li&gt;Linha 7 O endere√ßo de email de destino&lt;/li&gt;
&lt;li&gt;Linha 11 com o assunto&lt;/li&gt;
&lt;li&gt;Linha 13 com a mensagem a ser enviada&lt;/li&gt;
&lt;li&gt;Linha 18 com a senha do seu email&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="para-enviar-um-email-com-anexo"&gt;Para enviar um email com anexo&lt;/h2&gt;
&lt;p&gt;Para enviarmos anexos, vamos a um c√≥digo mais complicado. Percebi que todo mundo tem um m√©todo um pouco diferente pra fazer.
Fiz o codigo o mais simples possivel. Mas ainda vamos precisar de mais modulos.&lt;/p&gt;
&lt;p&gt;Em resumo, o passo essencial √© converter o arquivo em um Base64 antes de envi√°-lo. Meu c√≥digo funciona para arquivos de texto, arquivos pdf, imagens, arquivos de √°udio e arquivos de v√≠deo!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.multipart&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.text&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.base&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEBase&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;encoders&lt;/span&gt;


&lt;span class="n"&gt;fromaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SEU EMAIL&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;toaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;EMAIL DE DESTINO&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;From&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fromaddr&lt;/span&gt;
&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;To&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;
&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Subject&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ASSUNTO DO EMAIL&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TEXTO A SER ENVIADO&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;NOME DO ARQUIVO OU EXTENS√ÉO&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;attachment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CAMINHO DO ARQUIVO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;part&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEBase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;octet-stream&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_payload&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;attachment&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;encoders&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode_base64&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Disposition&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;attachment; filename= &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;smtp.gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;587&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starttls&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA SENHA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_string&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Esta feito o script de envio de emails.&lt;/p&gt;
&lt;p&gt;Em breve publico o script de coleta de logs e do BOT para o telegram.&lt;/p&gt;
&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;
&lt;p&gt;Fontes:&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/smtplib.html&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/email.mime.html&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/email-examples.html&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/email.html&lt;/p&gt;</content><category term="Python"></category><category term="emails"></category><category term="script"></category></entry><entry><title>Gerando senhas seguras utilizando python</title><link href="https://blog.chcdc.com.br/posts/gerando-senhas-seguras-utilizando-python" rel="alternate"></link><published>2018-01-09T19:48:25-02:00</published><updated>2018-01-09T19:48:25-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-01-09:/posts/gerando-senhas-seguras-utilizando-python</id><summary type="html">&lt;p&gt;Nesse &lt;a href="http://chcdc.com.br/posts/gerando-senhas-seguras"&gt;post&lt;/a&gt; ensinei a usar o pwgen para criar senhas, por√©m ele n√£o tem me suprido pois necessito de senhas especificas.&lt;/p&gt;
&lt;p&gt;Preciso enviar senhas de comprimento oito e apenas numeros e letras minusculas.&lt;/p&gt;
&lt;p&gt;Resolvi criar ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nesse &lt;a href="http://chcdc.com.br/posts/gerando-senhas-seguras"&gt;post&lt;/a&gt; ensinei a usar o pwgen para criar senhas, por√©m ele n√£o tem me suprido pois necessito de senhas especificas.&lt;/p&gt;
&lt;p&gt;Preciso enviar senhas de comprimento oito e apenas numeros e letras minusculas.&lt;/p&gt;
&lt;p&gt;Resolvi criar ent√£o um script em Python para gerar essas senhas.&lt;/p&gt;
&lt;p&gt;Vamos come√ßar por partes&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Primeiro vamos definir o executavel e importar os modulos &lt;strong&gt;random&lt;/strong&gt; e &lt;strong&gt;string&lt;/strong&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/local/bin/python3.6&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;string&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Vamos criar uma fun√ß√£o para gerar os numeros randomicos.&lt;/p&gt;
&lt;p&gt;Atribuiremos a variavel &lt;strong&gt;char&lt;/strong&gt; os caracteres minusculos e digitos numericos&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;randompassword&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascii_lowercase&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;passw&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;passw&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Perguntaremos a quantidade de senhas necessarias e o comprimento, as respostas ser√£o
armazenadas nas variaveis &lt;strong&gt;amount&lt;/strong&gt; e &lt;strong&gt;number&lt;/strong&gt; respectivamente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;amount&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Quantas senhas:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Qual o comprimento da senha?&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora para cada quantidade declarada na variavel &lt;strong&gt;amount&lt;/strong&gt; vamos imprimir uma
senha gerada randomicamente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Senha: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; - &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;randompassword&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O codigo final ficar√° dessa forma:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/local/bin/python3.6&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;string&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;randompassword&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascii_lowercase&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;passw&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;passw&lt;/span&gt;

&lt;span class="n"&gt;amount&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Quantas senhas:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Qual o comprimento da senha?&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;   Senha: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; - &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;randompassword&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Algo simples, mas pode ser implementado em outros codigos, e claro pode ser melhorado.&lt;/p&gt;
&lt;p&gt;Esse script encontra-se no meu &lt;a href="https://github.com/chcdc/scripts/blob/master/Python/generate_pass.py"&gt;Github&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Simples Assim üòÉ&lt;/p&gt;</content><category term="Python"></category></entry><entry><title>2017</title><link href="https://blog.chcdc.com.br/posts/2017" rel="alternate"></link><published>2018-01-01T12:00:45-02:00</published><updated>2018-01-01T12:00:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-01-01:/posts/2017</id><summary type="html">&lt;p&gt;E l√° vamos n√≥s recome√ßar.&lt;/p&gt;
&lt;p&gt;2017 pubiquei apenas um artigo aqui, enfrentei diversas dificuldades, tais como a perda de meu pai.&lt;/p&gt;
&lt;p&gt;Nesse ano que se inicia pretendo me dedicar mais ao blog e ao conteudo ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;E l√° vamos n√≥s recome√ßar.&lt;/p&gt;
&lt;p&gt;2017 pubiquei apenas um artigo aqui, enfrentei diversas dificuldades, tais como a perda de meu pai.&lt;/p&gt;
&lt;p&gt;Nesse ano que se inicia pretendo me dedicar mais ao blog e ao conteudo postado.&lt;/p&gt;
&lt;p&gt;A base do blog foi alterada de Octopress (Ruby) para Pelican (Python)&lt;/p&gt;
&lt;p&gt;Sendo Python uma das minhas linguagens preferidas, o blog ser√° mais prazeroso de manter.&lt;/p&gt;
&lt;p&gt;J√° tenho diversas coisas e ideias pra fazer aqui, como por exemplo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Melhorar o layout&lt;/li&gt;
&lt;li&gt;Inserir menus&lt;/li&gt;
&lt;li&gt;Inserir compartilhamento&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Isso e muito mais pretendo entregar.&lt;/p&gt;
&lt;p&gt;E l√° vamos n√≥s&lt;/p&gt;
&lt;p&gt;Feliz 2018 üòÜ&lt;/p&gt;</content><category term="misc"></category><category term="misc"></category><category term="Vida Pessoal"></category></entry><entry><title>Organizando arquivos por extens√£o usando Python</title><link href="https://blog.chcdc.com.br/posts/organizando-arquivos-por-extensao-usando-python" rel="alternate"></link><published>2017-01-25T11:45:45-02:00</published><updated>2017-01-25T11:45:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2017-01-25:/posts/organizando-arquivos-por-extensao-usando-python</id><summary type="html">&lt;p&gt;Recentemente fiz download de milhares de arquivos em pdf (n√£o foi pirataria ok?!)  e precisava organizar eles em uma pasta especifica.&lt;/p&gt;
&lt;p&gt;Pesquisei diversas formas de fazer isso, poderia fazer facilmente em &lt;strong&gt;Shell Script&lt;/strong&gt; mas como ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Recentemente fiz download de milhares de arquivos em pdf (n√£o foi pirataria ok?!)  e precisava organizar eles em uma pasta especifica.&lt;/p&gt;
&lt;p&gt;Pesquisei diversas formas de fazer isso, poderia fazer facilmente em &lt;strong&gt;Shell Script&lt;/strong&gt; mas como estou aprendendo &lt;strong&gt;Python&lt;/strong&gt; aceitei o desafio.&lt;/p&gt;
&lt;p&gt;Bom vamos ao c√≥digo.&lt;/p&gt;
&lt;!--more--&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env Python3.5&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;# Carlos Carvalho&lt;/span&gt;
&lt;span class="c1"&gt;# 21/01/2017&lt;/span&gt;
&lt;span class="c1"&gt;# Copiar/mover arquivos por extens√£o&lt;/span&gt;
&lt;span class="c1"&gt;# Copiar os arquivos em pdf do diretorio /mnt/DOCS/&lt;/span&gt;
&lt;span class="c1"&gt;# para o diretorio /mnt/DOCS/pdf&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nn"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nn"&gt;re&lt;/span&gt;

&lt;span class="c1"&gt;#Regex para identificar os arquivos em pdf&lt;/span&gt;
&lt;span class="n"&gt;filePattern&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;^(.*?)(.pdf)$&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;VERBOSE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Percorre o diretorio com um loop&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;amerFilename&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/mnt/DOCS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;mo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;filePattern&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Ignora os arquivos que n√£o s√£o pdf&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mo&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;

    &lt;span class="c1"&gt;# Obtem as diferentes partes do nome do arquivo&lt;/span&gt;
    &lt;span class="n"&gt;beforePart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;findPart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


    &lt;span class="c1"&gt;# Obtem os paths absolutos do arquivo&lt;/span&gt;
    &lt;span class="n"&gt;absWorkingDir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/mnt/DOCS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;PathFileEnd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/mnt/DOCS/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;amerFilename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;absWorkingDir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;PathFileEnd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;absWorkingDir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PathFileEnd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Move os arquivos&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Moving &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt; to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt; .. &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PathFileEnd&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PathFileEnd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="regex"></category></entry><entry><title>Criando um Bot do Telegram</title><link href="https://blog.chcdc.com.br/posts/criando-um-bot-do-telegram" rel="alternate"></link><published>2016-09-18T20:14:12-03:00</published><updated>2016-09-18T20:14:12-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-09-18:/posts/criando-um-bot-do-telegram</id><summary type="html">&lt;p&gt;Sim, resolvi me aventurar no desenvolvimento de um bot utilizando a &lt;a href="https://core.telegram.org/bots/api"&gt;API do Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Irei contar a minha saga da cria√ß√£o desse bot nesse maravilhoso &lt;a href="https://telegram.org"&gt;Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pra fazer um bot novo, √© muito simples.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Irei ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Sim, resolvi me aventurar no desenvolvimento de um bot utilizando a &lt;a href="https://core.telegram.org/bots/api"&gt;API do Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Irei contar a minha saga da cria√ß√£o desse bot nesse maravilhoso &lt;a href="https://telegram.org"&gt;Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pra fazer um bot novo, √© muito simples.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Irei partir do principio que voc√™ j√° tenha o Telegram instalado em seu smartphone e/ou computador  e que saiba o basico dele.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Adicione o @BotFather&lt;/li&gt;
&lt;li&gt;Escreva: /newbot&lt;/li&gt;
&lt;li&gt;Ele pedir√° um nome para o seu bot. Escreva o nome finalizado com _bot&lt;/li&gt;
&lt;li&gt;Se o nome estiver dispon√≠vel,o bot ser√° criado e voc√™ receber√° um token de acesso.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para testar seu bot acesse o seguinte link&lt;br&gt;
   https://api.telegram.org/bot[token]/getUpdates&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;Dever√° receber a seguinte resposta:&lt;br&gt;
   &lt;code&gt;{"ok":true,"result":[{}]"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Simples assim.&lt;/p&gt;</content><category term="Python"></category><category term="Telegram"></category><category term="bot"></category></entry><entry><title>Monitorar conexoes utilizando TCPDump</title><link href="https://blog.chcdc.com.br/posts/monitorar-conexoes-utilizando-tcpdump" rel="alternate"></link><published>2016-07-20T04:06:37-03:00</published><updated>2016-07-20T04:06:37-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-07-20:/posts/monitorar-conexoes-utilizando-tcpdump</id><summary type="html">&lt;p&gt;O tcpdump √© um famoso sniffer para sistemas Linux. Muito util para analise  e solu√ß√£o de problemas da rede.&lt;/p&gt;</summary><content type="html">&lt;p&gt;O tcpdump √© um famoso sniffer para sistemas Linux. Muito util para analise  e solu√ß√£o de problemas da rede.&lt;/p&gt;
&lt;p&gt;Sua documenta√ß√£o pode ser encontrada no site oficial.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.tcpdump.org"&gt;TCPDUMP&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;A maioria das distribui√ß√µes linux possuem binarios, caso n√£o possua, sua instala√ß√£o √© bem simples.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    sudo apt-get install tcpdump
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;!--more--&gt;
&lt;p&gt;Inicialmente n√£o √© necessario um parametro para sua execu√ß√£o, voc√™ apenas precisa executar como root, pois o tcpdump ir√° colocar sua placa de rede em modo promiscuo.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Por√©m podemos utilizar diversos filtros por meio de parametros&lt;/p&gt;
&lt;p&gt;Por padr√£o ele faz a captura da placa de rede ativa.Para selecionar a placa, devemos utilizar o parametro -i seguido da placa a ser monitorada&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump -i eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Podemos monitorar conexoes de origem utilizando o parametro &lt;em&gt;-src host&lt;/em&gt;. Tudo que vier do nosso gateway (192.168.1.1) para o nosso computador ( 192.168.1.10 ), ser√° monitorado com o seguinte comando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump -i eth0 src &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Se quisermos monitorar da forma inversa.Tudo que sair de nosso computador (192.168.1.10) para o nosso gateway, o comando ser√° o seguinte&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump -i eth0 dst &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Tamb√©m √© possivel especificar a porta de origem e destino com o comando &lt;em&gt;src port&lt;/em&gt; e &lt;em&gt;dst port&lt;/em&gt; . Um exemplo √© monitorar a porta 443&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump -i eth0 dst port &lt;span class="m"&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para que o tcpdump n√£o converta os endere√ßos e portas, devemos utilizar o parametro &lt;em&gt;-n&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump -i eth0 -n host www.google.com.br
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Podemos tambem utilizar operadores booleanos para um filtro mais refinado.&lt;/p&gt;
&lt;p&gt;Por exemplo, capturar todos os pacotes da porta 80 e 443 da rede 192.168.1.0/16&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    tcpdump -i eth0 -n net &lt;span class="m"&gt;192&lt;/span&gt;.168 and port &lt;span class="m"&gt;80&lt;/span&gt; and port &lt;span class="m"&gt;443&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Muitas op√ß√µes podem ser obtidas com o tcpdump, essas s√£o algumas op√ß√µes basicas pra iniciar com sniffers.&lt;/p&gt;</content><category term="Network"></category></entry><entry><title>Instalando Telegram-Cli</title><link href="https://blog.chcdc.com.br/posts/instalando-telegram-cli" rel="alternate"></link><published>2016-04-22T20:43:33-03:00</published><updated>2016-04-22T20:43:33-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-04-22:/posts/instalando-telegram-cli</id><summary type="html">&lt;p&gt;Telegram-CLI √© um cliente do Telegram baseado na linguagem lua, ele √© executado a partir do terminal.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Instale as dependencias&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;apt-get install libreadline-dev libconfig-dev libssl-dev
 lua5.2 liblua5.2-dev libevent-dev libjansson-dev libpython-dev
 make git-core
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Navege ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Telegram-CLI √© um cliente do Telegram baseado na linguagem lua, ele √© executado a partir do terminal.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Instale as dependencias&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;apt-get install libreadline-dev libconfig-dev libssl-dev
 lua5.2 liblua5.2-dev libevent-dev libjansson-dev libpython-dev
 make git-core
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Navege at√© o diretorio de instalacao&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cd /opt/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Fa√ßa o clone do repositorio&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git clone --recursive https://github.com/vysheng/tg.git &amp;amp;&amp;amp; cd tg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Compile&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;./configure
make
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pronto, o proximo passo √© a configura√ß√£o do Telegram&lt;/p&gt;
&lt;p&gt;Acesse a pasta do executavel&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cd /opt/tg/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Execute o Telegram-Cli com o seguinte comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/opt/tg/bin/telegram-cli -W -k tg-server.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Na primeira execu√ß√£o ser√° solicitado o numero de telefone e o codigo que ser√° enviado por sms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Telegram&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Copyright&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="mi"&gt;2013&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2015&lt;/span&gt; &lt;span class="n"&gt;Vitaly&lt;/span&gt; &lt;span class="n"&gt;Valtman&lt;/span&gt;
&lt;span class="n"&gt;Telegram&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt; &lt;span class="n"&gt;comes&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;ABSOLUTELY&lt;/span&gt; &lt;span class="n"&gt;NO&lt;/span&gt; &lt;span class="n"&gt;WARRANTY&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;free&lt;/span&gt; &lt;span class="n"&gt;software&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;welcome&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;redistribute&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;
&lt;span class="n"&gt;under&lt;/span&gt; &lt;span class="n"&gt;certain&lt;/span&gt; &lt;span class="n"&gt;conditions&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;show_license&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; for details.&lt;/span&gt;
&lt;span class="n"&gt;Telegram&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt; &lt;span class="n"&gt;uses&lt;/span&gt; &lt;span class="n"&gt;libtgl&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt; &lt;span class="n"&gt;dir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;~/.&lt;/span&gt;&lt;span class="n"&gt;telegram&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;~/.&lt;/span&gt;&lt;span class="n"&gt;telegram&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;~/.&lt;/span&gt;&lt;span class="n"&gt;telegram&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;cli&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;downloads&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt;
&lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;554499999999&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;--&lt;/span&gt;&lt;span class="n"&gt;colocar&lt;/span&gt; &lt;span class="n"&gt;aqui&lt;/span&gt; &lt;span class="n"&gt;seu&lt;/span&gt; &lt;span class="n"&gt;n√∫mero&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;telefone&lt;/span&gt;
&lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;call&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;phone&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="mi"&gt;12345&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;--&lt;/span&gt; &lt;span class="n"&gt;colocar&lt;/span&gt; &lt;span class="n"&gt;aqui&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;c√≥digo&lt;/span&gt; &lt;span class="n"&gt;que&lt;/span&gt;
                            &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="n"&gt;pr√≥prio&lt;/span&gt; &lt;span class="n"&gt;Telegram&lt;/span&gt; &lt;span class="n"&gt;enviar√°&lt;/span&gt; &lt;span class="n"&gt;por&lt;/span&gt; &lt;span class="n"&gt;SMS&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pronto! Est√° configurado!&lt;/p&gt;
&lt;p&gt;Para enviar mensagens basta executar:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/opt/tg/bin/telegram-cli -W -k tg-server.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="configurar-para-envio-de-notificacoes-via-sistema"&gt;Configurar para envio de notifica√ß√µes via sistema&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;Ap√≥s o telegram-cli estar instalado e configurado, crie o seguinte arquivo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo vim /etc/profile.d/TelNotdata.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Acrescente o conteudo&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;span class="normal"&gt; 1&lt;/span&gt;
&lt;span class="normal"&gt; 2&lt;/span&gt;
&lt;span class="normal"&gt; 3&lt;/span&gt;
&lt;span class="normal"&gt; 4&lt;/span&gt;
&lt;span class="normal"&gt; 5&lt;/span&gt;
&lt;span class="normal"&gt; 6&lt;/span&gt;
&lt;span class="normal"&gt; 7&lt;/span&gt;
&lt;span class="normal"&gt; 8&lt;/span&gt;
&lt;span class="normal"&gt; 9&lt;/span&gt;
&lt;span class="normal"&gt;10&lt;/span&gt;
&lt;span class="normal"&gt;11&lt;/span&gt;
&lt;span class="normal"&gt;12&lt;/span&gt;
&lt;span class="normal"&gt;13&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelNotIP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;hostname -I&lt;span class="p"&gt;|&lt;/span&gt;sed &lt;span class="s1"&gt;&amp;#39;s/[ ]*$//&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelNotPort&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;8080&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TempFileDir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/var/tmp/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramHomePath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/opt/tg/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramScriptPath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramHomePath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;scripts/user/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramGenericPath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramHomePath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;scripts/generic/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramScript&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramGenericPath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;telegram.sh&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramCli&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramHomePath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;bin/telegram-cli&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramLog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TempFileDir&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;tg.log&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;ReceiveLua&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramGenericPath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;receive.lua&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramTo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;PrimeiroNome_SegundoNome&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;EmailTo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;seu@email.com&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;Torne ele executavel&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo chmod +x /etc/profile.d/TelNotdata.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;De um start no Daemon do Telegram-CLI&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/opt/tg/bin/telegram-cli -vvvvRC -k tg-server.pub -W -dL tg.log -P 1234 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Verifique se esta rodando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ps -ef | grep telegram
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A saida √© algo parecido com isso&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;root 1736  978  0 01:53 pts/0  00:00:01 bin/telegram-cli -vvvvRC -k tg-server.pub -W -dL tg.log -P 1234
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para enviar mensagens √© simples!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;echo &amp;quot;msg Firstname_Surname Test123&amp;quot; | nc 127.0.0.1 1234
echo &amp;quot;send_text Firstname_Surname  switch_icons.txt&amp;quot; | nc 127.0.0.1 1234
echo &amp;quot;send_photo Firstname_Surname  logo.png&amp;quot; | nc 127.0.0.1 1234
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Dessa forma, voce pode criar scripts para enviar mensagens automaticas, 
inclusive quando ocorrer algo no servidor&lt;/p&gt;</content><category term="Telegram"></category></entry><entry><title>Como Gerar Senhas seguras com PWGEN</title><link href="https://blog.chcdc.com.br/posts/como-gerar-senhas-seguras-com-pwgen" rel="alternate"></link><published>2016-01-20T01:48:25-02:00</published><updated>2016-01-20T01:48:25-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-01-20:/posts/como-gerar-senhas-seguras-com-pwgen</id><summary type="html">&lt;p&gt;Frequentemente preciso enviar senhas de VPN para clientes, criar ou alterar senhas novas para os servidores.
Existem diversas ferramentas online que isso possa ser feito, mas ao meu ver, o tempo que demoro em acessar ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Frequentemente preciso enviar senhas de VPN para clientes, criar ou alterar senhas novas para os servidores.
Existem diversas ferramentas online que isso possa ser feito, mas ao meu ver, o tempo que demoro em acessar essas ferramentas se torna muito grande.
Ap√≥s algumas pesquisas encontrei um pacote que pode fazer isso pelo terminal.&lt;/p&gt;
&lt;p&gt;Para instalar vamos baixar e compilar o pacote.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;Primeiramente vamos baixar o source do pacote&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    wget http://downloads.sourceforge.net/project/pwgen/pwgen/2.07/pwgen-2.07.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;
Vamos descompactar o arquivo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ tar xvf pwgen-2.07.tar.gz
    $ &lt;span class="nb"&gt;cd&lt;/span&gt; pwgen-2.07
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora vamos compilar&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ ./configure
    $ make
    $ sudo make install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora √© s√≥ usar o comando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ pwgen
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Por padr√£o ele gera uma sequencia de caracteres alfanumericos maiusculos e minusculos e numeros com 8 caracteres. Mas caso queira, voc√™ pode definir o tamanho maior para as senhas.&lt;/p&gt;
&lt;p&gt;&lt;img alt="pwgen-pass" src="/images/pass-pwgen.png"&gt;
Por exemplo, gerar senhas com 20 caracteres.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ pwgen &lt;span class="m"&gt;20&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="pwgen" src="/images/pwgen-20.png"&gt;
Voc√™ pode gerar senhas de infinitas formas, para isso, basta ler o arquivo helper usando o parametro -h&lt;/p&gt;
&lt;p&gt;&lt;img alt="pewgen-help" src="/images/pwgen-help.png"&gt;&lt;/p&gt;
&lt;p&gt;Simples assim :)&lt;/p&gt;</content><category term="Shell Script"></category></entry><entry><title>Registro de acesso</title><link href="https://blog.chcdc.com.br/posts/registro-de-acesso" rel="alternate"></link><published>2016-01-05T01:59:44-02:00</published><updated>2016-01-05T01:59:44-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-01-05:/posts/registro-de-acesso</id><summary type="html">&lt;p&gt;Tenho um notebook que fica grande parte do tempo no meu quarto, ent√£o quando n√£o estou em casa, fica liberado para alguem usar.&lt;/p&gt;
&lt;p&gt;Mas a√≠ pensei, como saber em tempo real quem acessou minha maquina ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Tenho um notebook que fica grande parte do tempo no meu quarto, ent√£o quando n√£o estou em casa, fica liberado para alguem usar.&lt;/p&gt;
&lt;p&gt;Mas a√≠ pensei, como saber em tempo real quem acessou minha maquina? A solu√ß√£o √© simples!&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;Criei um script pra cada vez que houver logon no sistema tira uma foto e envia ao meu Email!&lt;/p&gt;
&lt;p&gt;O script √© bem simples:&lt;/p&gt;
&lt;div class="gist"&gt;
    &lt;script src='https://gist.github.com/129b0f739b27db186eb7.js'&gt;&lt;/script&gt;
    &lt;noscript&gt;
        &lt;pre&gt;&lt;code&gt;#!/bin/bash

now=`date +%Y%m%d-%H%M%S`

 fswebcam -F 20 -r 1280x720 --jpeg 100 -D 1 $now.jpeg
 sendemail -f carloshccarvalho@hotmail.com -t chenriquecdc@gmail.com -u "Opa! Noticias" -m "Alguem acessou sua maquina agora!" -s smtp.live.com:587 -xu carloshccarvalho@hotmail.com -xp [ Password ] -a $HOME/$now.jpeg&lt;/code&gt;&lt;/pre&gt;
    &lt;/noscript&gt;
&lt;/div&gt;
&lt;p&gt;Os comandos se resumem no seguinte:&lt;/p&gt;
&lt;p&gt;&lt;b&gt;&lt;code&gt;now=date +%Y%m%d-%H%M%S&lt;/code&gt;&lt;/b&gt; Variavel que recebe a data atual do sistema.
&lt;br&gt;&lt;code&gt;fswebcam&lt;/code&gt; - Software que permite tirar fotos a partir do terminal
    &lt;br&gt; - &lt;code&gt;-F&lt;/code&gt; Define o numero de Frames para captar
    &lt;br&gt; - &lt;code&gt;-r&lt;/code&gt; Define a resolu√ß√£o da captura
    &lt;br&gt; - &lt;code&gt;--jpeg 100&lt;/code&gt; Formato e qualidade da saida
    &lt;br&gt; - &lt;code&gt;-D 1&lt;/code&gt; Tempo de delay para a captura
    &lt;br&gt; - &lt;code&gt;$now.jpeg&lt;/code&gt; Arquivo que ser√° salvo&lt;/p&gt;
&lt;p&gt;&lt;b&gt;&lt;code&gt;sendemail&lt;/code&gt; &lt;/b&gt; - Software de envio de emails
    &lt;br&gt;  - &lt;code&gt;-f&lt;/code&gt; [FROM] Email do remetente
    &lt;br&gt;  - &lt;code&gt;-t&lt;/code&gt; [TO] Email de destino
    &lt;br&gt;  - &lt;code&gt;-u&lt;/code&gt; [Subject] Assunto
    &lt;br&gt;  - &lt;code&gt;-m&lt;/code&gt; [Message] Mensagem do email
    &lt;br&gt;  - &lt;code&gt;-s&lt;/code&gt; [SMTP] Servidor de Saida SMTP
    &lt;br&gt;  - &lt;code&gt;-xu&lt;/code&gt; [Username] Conta de email que sera utilizada para envio
    &lt;br&gt;  - &lt;code&gt;-xp&lt;/code&gt; [ Password] Senha
    &lt;br&gt;  - &lt;code&gt;-a&lt;/code&gt; [FILE] Anexo do Email&lt;/p&gt;
&lt;p&gt;Simples assim :)&lt;/p&gt;</content><category term="Shell Script"></category><category term="sysadmin"></category></entry><entry><title>Removendo v√°rios arquivos de uma lista gigante</title><link href="https://blog.chcdc.com.br/posts/removendo-varios-arquivos-de-uma-lista-gigante" rel="alternate"></link><published>2016-01-02T23:39:17-02:00</published><updated>2016-01-02T23:39:17-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-01-02:/posts/removendo-varios-arquivos-de-uma-lista-gigante</id><summary type="html">&lt;p&gt;Por experi√™ncia pr√≥pria, vez por outra preciso apagar v√°rios arquivos gigantescos (geralmente logs) de uma √∫nica vez e a seguinte mensagem √© gerada:&lt;/p&gt;
&lt;p&gt;/bin/rm Argument list too long (Lista de argumento muito longa)&lt;/p&gt;
&lt;p&gt;E ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Por experi√™ncia pr√≥pria, vez por outra preciso apagar v√°rios arquivos gigantescos (geralmente logs) de uma √∫nica vez e a seguinte mensagem √© gerada:&lt;/p&gt;
&lt;p&gt;/bin/rm Argument list too long (Lista de argumento muito longa)&lt;/p&gt;
&lt;p&gt;E da√≠, o que fazer?&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;Basta entrar no diret√≥rio onde encontram-se os arquivos e executar algumas das alternativas de comando.&lt;/p&gt;
&lt;p&gt;Para apagar todos os arquivos que contenham "2015" em seu nome:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ &lt;span class="k"&gt;for&lt;/span&gt; a &lt;span class="k"&gt;in&lt;/span&gt; *2015*&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; rm &lt;span class="nv"&gt;$a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para apagar todos os arquivos que possuam a extens√£o .log:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ &lt;span class="k"&gt;for&lt;/span&gt; a &lt;span class="k"&gt;in&lt;/span&gt; *.log&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; rm &lt;span class="nv"&gt;$a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Bem simples! :)&lt;/p&gt;</content><category term="Linux"></category><category term="sysadmin"></category></entry></feed>