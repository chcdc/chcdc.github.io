<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Carlos Carvalho</title><link href="https://blog.chcdc.com.br/" rel="alternate"></link><link href="https://blog.chcdc.com.br/feeds.atom" rel="self"></link><id>https://blog.chcdc.com.br/</id><updated>2019-05-20T00:00:00-03:00</updated><entry><title>OpenVPN</title><link href="https://blog.chcdc.com.br/posts/openvpn" rel="alternate"></link><published>2019-05-20T00:00:00-03:00</published><updated>2019-05-20T00:00:00-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2019-05-20:/posts/openvpn</id><summary type="html">&lt;p&gt;OpenVPN √© uma aplica√ß√£o VPN de c√≥digo aberto que permite criar e participar de uma rede privada de forma segura atrav√©s da Internet p√∫blica.&lt;/p&gt;
&lt;p&gt;Vamos instalar e configurar o OpenVPN em um servidor CentOS 7.&lt;/p&gt;
&lt;p&gt;Levando em considera√ß√£o que o servidor Linux baseado na distribui√ß√£o CentOS 7 esteja devidamente instalado ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;OpenVPN √© uma aplica√ß√£o VPN de c√≥digo aberto que permite criar e participar de uma rede privada de forma segura atrav√©s da Internet p√∫blica.&lt;/p&gt;
&lt;p&gt;Vamos instalar e configurar o OpenVPN em um servidor CentOS 7.&lt;/p&gt;
&lt;p&gt;Levando em considera√ß√£o que o servidor Linux baseado na distribui√ß√£o CentOS 7 esteja devidamente instalado e com a rede configurada, vamos iniciar a instala√ß√£o.&lt;/p&gt;
&lt;!--more--&gt;

&lt;h3&gt;Configurando o sistema&lt;/h3&gt;
&lt;p&gt;Desabilite o SELinux&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sed -i &lt;span class="s1"&gt;&amp;#39;s/^SELINUX=.*/SELINUX=disabled/g&amp;#39;&lt;/span&gt; /etc/sysconfig/selinux &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; cat /etc/sysconfig/selinux 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Desabilite o firewalld&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl stop firewalld
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl disable firewalld
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Ap√≥s as altera√ß√µes reinicie o sistema para aplicar a configura√ß√£o&lt;/p&gt;
&lt;p&gt;Ajuste o kernel para habilitar o modo de roteamento:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; net.ipv4.ip_forward &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &amp;gt;&amp;gt; /etc/sysctl.conf
&lt;span class="gp"&gt;#&lt;/span&gt; sysctl -p
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Atualize o sistema operacional&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; yum upgrade -y
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Instalando OpenVPN&lt;/h3&gt;
&lt;p&gt;O reposit√≥rio Extra Packages for Enterprise Linux (EPEL) √© um reposit√≥rio adicional gerenciado pelo Projeto Fedora contendo pacotes n√£o padr√£o, mas populares. O OpenVPN n√£o est√° dispon√≠vel nos reposit√≥rios padr√£o do CentOS, mas est√° dispon√≠vel no EPEL, ent√£o instale o EPEL:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; yum install epel-release -y &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; yum update -y
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pr√≥ximo passo √© instalar os pacotes necess√°rios&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; yum install openvpn vim -y
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Usando o curl, fa√ßa o download do Easy RSA. 
Recomendo o uso do easy-rsa-2, pois h√° mais documenta√ß√£o dispon√≠vel para esta vers√£o. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; curl -L https://github.com/OpenVPN/easy-rsa-old/archive/2.3.3.tar.gz -o /tmp/easyrsa.tar.gz
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Extraia o pacote e crie o diret√≥rio em /etc/openvpn/&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; tar xfz /tmp/easyrsa.tar.gz
&lt;span class="gp"&gt;#&lt;/span&gt; sudo mkdir /etc/openvpn/easy-rsa 
&lt;span class="gp"&gt;#&lt;/span&gt; sudo mkdir /etc/openvpn/keys
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Copie a estrutura do diret√≥rio easy-rsa para o diret√≥rio /etc/openvpn/easy-rsa para facilitar a administra√ß√£o:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo cp -rfv easy-rsa-old-2.3.3/easy-rsa/2.0/* /etc/openvpn/easy-rsa/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Altere o diret√≥rio para um usu√°rio n√£o root&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; chown &lt;span class="s2"&gt;&amp;quot;user&amp;quot;&lt;/span&gt; /etc/openvpn/easy-rsa/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Depois que esses programas forem instalados e tiverem sido movidos para os locais corretos em seu sistema, a pr√≥xima etapa √© personalizar a configura√ß√£o do lado do servidor do OpenVPN.&lt;/p&gt;
&lt;h3&gt;Configurando OpenVPN&lt;/h3&gt;
&lt;p&gt;Temos muitas formas de configurar o OpenVPN, neste documento vamos fazer a forma mais comum de conex√£o.&lt;/p&gt;
&lt;p&gt;Crie o arquivo de configura√ß√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; vim /etc/openvpn/server.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Vamos a Configura√ß√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; IP &lt;span class="k"&gt;do&lt;/span&gt; servidor VPN
&lt;span class="go"&gt;local xxx.xxx.xxx.xxx&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Porta Utilizada
&lt;span class="go"&gt;port 1194&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Protocolo de Conex√£o e porta utilizada
&lt;span class="go"&gt;proto udp &lt;/span&gt;
&lt;span class="go"&gt;dev tun0 &lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Permite que o t√∫nel &lt;span class="k"&gt;continue&lt;/span&gt; aberto mesmo que o endere√ßo IP da outra m√°quina mude
&lt;span class="go"&gt;float&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;&lt;span class="c1"&gt;# Localiza√ß√£o das Chaves e certificados&lt;/span&gt;
&lt;span class="go"&gt;ca /etc/openvpn/keys/ca.crt &lt;/span&gt;
&lt;span class="go"&gt;cert /etc/openvpn/keys/server.crt&lt;/span&gt;
&lt;span class="go"&gt;key /etc/openvpn/keys/server.key  # This file should be kept secret&lt;/span&gt;
&lt;span class="go"&gt;dh /etc/openvpn/keys/dh2048.pem&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Configura o OpenVPN para funcionar como uma 
&lt;span class="gp"&gt;#&lt;/span&gt; sub-rede e informa √† m√°quina cliente qual endere√ßo utilizar
&lt;span class="go"&gt;topology subnet&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Configura√ß√£o &lt;span class="k"&gt;do&lt;/span&gt; endere√ßo &lt;span class="k"&gt;do&lt;/span&gt; servidor
&lt;span class="go"&gt;server 10.1.1.0 255.255.255.0 &lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt;Configura√ß√£o para manter os endere√ßos est√°ticos dos clientes, 
&lt;span class="gp"&gt;#&lt;/span&gt; caso o OpenVPN reinicie, 
&lt;span class="gp"&gt;#&lt;/span&gt; poder√° ser atribu√≠do aos clientes de reconex√£o o mesmo endere√ßo IP
&lt;span class="go"&gt;ifconfig-pool-persist ipp.txt&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Informa a configura√ß√£o de cada cliente
&lt;span class="go"&gt;client-config-dir /etc/openvpn/ccd/&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Configura√ß√£o para setar o DNS dos clientes, no exemplo abaixo estamos utilizando o opendns.com
&lt;span class="go"&gt;push &amp;quot;dhcp-option DNS 208.67.222.222&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;push &amp;quot;dhcp-option DNS 208.67.220.220&amp;quot;&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Envia um ‚Äúping‚Äù de um lado para o outro, 
&lt;span class="gp"&gt;#&lt;/span&gt; de modo que cada lado saiba quando o outro lado ficou inativo.
&lt;span class="gp"&gt;#&lt;/span&gt; Ping a cada &lt;span class="m"&gt;10&lt;/span&gt; segundos, declara como inativo se nenhum ping &lt;span class="k"&gt;for&lt;/span&gt; recebido 
&lt;span class="gp"&gt;#&lt;/span&gt; durante um tempo de &lt;span class="m"&gt;120&lt;/span&gt; segundos
&lt;span class="go"&gt;keepalive 10 120&lt;/span&gt;


&lt;span class="gp"&gt;#&lt;/span&gt; Chave de seguran√ßa Cipher. Deve conter no arquivo cliente e servidor.
&lt;span class="go"&gt;cipher AES-256-CBC&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Compacta√ß√£o 
&lt;span class="go"&gt;comp-lzo&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Quantidade maxima de clientes 
&lt;span class="go"&gt;max-clients 10&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Op√ß√µes Persistentes
&lt;span class="go"&gt;persist-key&lt;/span&gt;
&lt;span class="go"&gt;persist-tun&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Arquivo de status curto, exibindo as conex√µes atuais, truncadas e reescrito a cada minuto
&lt;span class="go"&gt;status /var/log/openvpn-status.log&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Log OpenVPN
&lt;span class="go"&gt;log-append  /var/log/openvpn.log&lt;/span&gt;
&lt;span class="go"&gt;verb 3&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Notificar o cliente que quando o servidor &lt;span class="k"&gt;for&lt;/span&gt; reiniciado pode reconectar-se automaticamente.
&lt;span class="go"&gt;explicit-exit-notify 1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Gerando Chaves e certificados Servidor&lt;/h3&gt;
&lt;p&gt;Come√ßaremos nosso processo de gera√ß√£o de chaves e certificados criando um diret√≥rio no qual o Easy RSA armazenar√° todas as chaves e certificados gerados:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /etc/openvpn/easy-rsa/keys
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Vamos editar as vari√°veis padr√µes que ficam no arquivo &lt;strong&gt;vars&lt;/strong&gt; em &lt;strong&gt;/etc/openvpn/easy-rsa/&lt;/strong&gt; :&lt;/p&gt;
&lt;p&gt;V√° at√© o final do arquivo e altere os valores abaixo&lt;/p&gt;
&lt;p&gt;KEY_NAME: O nome do servidor, o mesmo utilizado para a cria√ß√£o das chaves "server.key" e "server.crt"&lt;br /&gt;
export KEY_COUNTRY="BR"&lt;br /&gt;
export KEY_PROVINCE="PR"&lt;br /&gt;
export KEY_CITY="Maringa"&lt;br /&gt;
export KEY_ORG="Empresa"&lt;br /&gt;
export KEY_EMAIL="vpn@company.com.br"&lt;br /&gt;
export KEY_CN=openvpn&lt;br /&gt;
export KEY_NAME="server"&lt;br /&gt;
export KEY_OU="Infraestrutura"&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;Salve e feche o arquivo&lt;/p&gt;
&lt;p&gt;Para come√ßar a gerar as chaves e os certificados, v√° para o diret√≥rio easy-rsa e carregue as vari√°veis declaradas no arquivo vars na mem√≥ria:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa
&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; ./vars
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Execute o script clean-all do Easy RSA para remover todas as chaves e certificados j√° existentes na pasta e gerar a autoridade de certifica√ß√£o:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;LEMBRE-SE: esse comando remove todas as chaves e certificados j√° criados. N√£o o execute em produ√ß√£o&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ./clean-all
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Este script gera um arquivo chamado ca.key. Essa √© a chave privada usada para assinar seu servidor e os certificados dos clientes. Se estiver perdido, voc√™ n√£o poder√° mais confiar em nenhum certificado dessa autoridade de certifica√ß√£o e, se algu√©m conseguir acessar esse arquivo, poder√° assinar novos certificados e acessar sua VPN sem o seu conhecimento. 
Por esse motivo, o OpenVPN recomenda armazenar o ca.key em um local que possa estar offline o m√°ximo poss√≠vel e s√≥ deve ser ativado ao criar novos certificados.&lt;/p&gt;
&lt;p&gt;Em seguida, construa a autoridade de certifica√ß√£o com o script build-ca. Voc√™ ser√° solicitado a inserir valores para os campos de certificado, mas se voc√™ definir as vari√°veis no arquivo vars anteriormente, todas as suas op√ß√µes j√° estar√£o definidas como padr√µes. Voc√™ pode pressionar ENTER para aceitar os padr√µes de cada um:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ./build-ca
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Gere a chave de criptografia est√°tica com o seguinte comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; openvpn --genkey --secret /etc/openvpn/keys/vpn_server.tlsauth
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Em seguida, crie uma chave e um certificado para o servidor usando o script build-key-server:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ./build-key-server server
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Assim como na cria√ß√£o da autoridade de certifica√ß√£o, voc√™ ver√° os valores que definiu como padr√£o para poder pressionar ENTER nesses prompts. Al√©m disso, voc√™ ser√° solicitado a inserir uma senha de desafio e um nome de empresa opcional. Se voc√™ digitar uma senha de desafio, voc√™ ser√° solicitado a se conectar √† VPN do seu cliente. Se voc√™ n√£o quiser definir uma senha de desafio, deixe esta linha em branco e pressione ENTER. No final, insira Y para confirmar as altera√ß√µes.&lt;/p&gt;
&lt;p&gt;A √∫ltima parte da cria√ß√£o das chaves e dos certificados do servidor est√° gerando um arquivo de troca de chaves Diffie-Hellman. Use o script build-dh para fazer isso. Isso pode levar alguns minutos para ser conclu√≠do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ./build-dh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Quando o servidor terminar de gerar o arquivo de troca de chaves, copie as chaves do servidor e os certificados do diret√≥rio keys no diret√≥rio openvpn:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa/keys/
&lt;span class="gp"&gt;#&lt;/span&gt; sudo cp dh2048.pem ca.crt server.crt server.key /etc/openvpn/keys
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Gerando Chaves e certificados Cliente&lt;/h3&gt;
&lt;p&gt;Cada cliente tamb√©m precisar√° de um certificado para que o servidor OpenVPN possa autentic√°-lo. Essas chaves e certificados ser√£o criados no servidor e voc√™ ter√° que copi√°-los para seus clientes. √â aconselh√°vel gerar chaves e certificados separados para cada cliente que voc√™ pretende conectar √† sua VPN.&lt;/p&gt;
&lt;p&gt;Crie um certificado de cliente teste. N√£o crie um certificado para ser utilizado futuramente, pois o mesmo ser√° utilizado para criar o arquivo de revoga√ß√£o de certificados e ser√° invalidado logo em seguida. Preste aten√ß√£o em alterar o endere√ßo de email para cada certificado novo:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa/
&lt;span class="gp"&gt;#&lt;/span&gt; ./build-key cert-test
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Revogue o certificado teste, criado anteriormente, para gerar o arquivo crl.pem, que ser√° respons√°vel por controlar os certificados revogados.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ./revoke-full cert-teste
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Sempre que um certificado for revogado, o arquivo crl.pem dever√° ser copiado para a raiz do servidor OpenVPN para que o mesmo possa ser lido:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; cp /etc/openvpn/rsa/keys/crl.pem /etc/openvpn
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Agora vamos criar o certificado, como vamos apenas criar esse, vamos nome√°-lo de client , mas voc√™ pode alterar isso para um nome mais descritivo se quiser:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /etc/openvpn/easy-rsa/
&lt;span class="gp"&gt;$&lt;/span&gt; ./build-key client
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Copie o arquivo de configura√ß√£o do OpenSSL com vers√£o, openssl-1.0.0.cnf, para um nome sem vers√£o, openssl.cnf. N√£o fazer isso pode resultar em um erro em que o OpenSSL n√£o consegue carregar a configura√ß√£o porque n√£o pode detectar sua vers√£o&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; cp /etc/openvpn/easy-rsa/openssl-1.0.0.cnf /etc/openvpn/easy-rsa/openssl.cnf
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Iniciando OpenVPN&lt;/h3&gt;
&lt;p&gt;Vamos configurar o OpenVPN para iniciar na inicializa√ß√£o. Para fazer isso, ative o servidor OpenVPN adicionando-o ao systemctl&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo systemctl -f &lt;span class="nb"&gt;enable&lt;/span&gt; openvpn@server.service
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Inicie o servi√ßo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo systemctl start openvpn@server.service
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Verifique se n√£o houve erros durante a inicializa√ß√£o do servi√ßo. Caso tenha erros, verifique o arquivo de log /var/log/openvpn.log&lt;/p&gt;
&lt;h3&gt;Criando rotas estaticas&lt;/h3&gt;
&lt;p&gt;Vamos criar para cada cliente uma configura√ß√£o de rede individual&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /etc/openvpn/ccd
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Dentro do diret√≥rio, crie um arquivo com o nome exatamente igual ao que foi gerado o certificado, no nosso caso √© client&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; touch /etc/openvpn/ccd/client
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Vamos inserir as informa√ß√µes necess√°rias.&lt;/p&gt;
&lt;p&gt;[Optional]
Caso deseja que cada cliente tenha um endere√ßo setado manualmente, insira no inicio do arquivo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;ifconfig-push 10.1.1.1 255.255.255.0 &lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;[/optional]&lt;/p&gt;
&lt;p&gt;Insira as rotas da rede local e a rede openvpn, caso deseja que ele acesse a mesma&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;push &amp;quot;route 10.1.1.0 255.255.255.0&amp;quot;&lt;/span&gt;
&lt;span class="go"&gt;push &amp;quot;route 10.42.12.0 255.255.254.0&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Insira as rotas desejadas, sempre comentando o destino &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; Algum lugar &lt;span class="k"&gt;do&lt;/span&gt; mundo
&lt;span class="go"&gt;push &amp;quot;route 200.200.200.1 255.255.255.0&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Configurando o Firewall&lt;/h3&gt;
&lt;p&gt;Para que o servidor fa√ßa os redirecionamentos necess√°rios e aceite conex√µes precisamos setar isso no iptables&lt;/p&gt;
&lt;p&gt;Execute os seguintes comandos&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &amp;gt; /proc/sys/net/ipv4/ip_forward
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -P FORWARD ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A INPUT -i tun+ -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A FORWARD -i tun+ -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -t nat -A POSTROUTING -o ens32 -j MASQUERADE
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A FORWARD -i tun0 -o tun0 -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A FORWARD -i tun0 -o ens32 -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A FORWARD -i ens32 -o tun0 -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A INPUT -p tcp --dport &lt;span class="m"&gt;1194&lt;/span&gt; -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -A INPUT -p udp --dport &lt;span class="m"&gt;1194&lt;/span&gt; -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -I INPUT -i tun+ -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -I OUTPUT -o tun+ -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -I FORWARD -i tun+ -j ACCEPT
&lt;span class="gp"&gt;#&lt;/span&gt; iptables -I FORWARD -o tun+ -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Configurando o Cliente&lt;/h3&gt;
&lt;p&gt;Os certificados e chave que ser√£o inseridos no final do arquivo se encontram em /etc/openvpn/easy-rsa/keys/
Sendo eles
    * ca - ca.crt 
    * cert - client.crt
    * key - client.key&lt;/p&gt;
&lt;p&gt;Crie o arquivo client.ovpn com as seguintes configura√ß√µes&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;client&lt;/span&gt;
&lt;span class="go"&gt;pull&lt;/span&gt;
&lt;span class="go"&gt;dev tun&lt;/span&gt;
&lt;span class="go"&gt;proto udp&lt;/span&gt;
&lt;span class="go"&gt;remote &amp;lt;ip external&amp;gt; 1194 udp&lt;/span&gt;
&lt;span class="go"&gt;user nobody&lt;/span&gt;
&lt;span class="go"&gt;group nogroup&lt;/span&gt;
&lt;span class="go"&gt;comp-lzo&lt;/span&gt;
&lt;span class="go"&gt;verb 3&lt;/span&gt;
&lt;span class="go"&gt;resolv-retry infinite&lt;/span&gt;
&lt;span class="go"&gt;persist-key&lt;/span&gt;
&lt;span class="go"&gt;persist-tun&lt;/span&gt;
&lt;span class="go"&gt;mute-replay-warnings&lt;/span&gt;
&lt;span class="go"&gt;auth-nocache&lt;/span&gt;
&lt;span class="go"&gt;float&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Ciphers
&lt;span class="go"&gt;remote-cert-tls server&lt;/span&gt;
&lt;span class="go"&gt;tls-version-min 1.2&lt;/span&gt;
&lt;span class="go"&gt;tls-cipher TLS-DHE-RSA-WITH-AES-256-GCM-SHA384&lt;/span&gt;
&lt;span class="go"&gt;cipher AES-256-CBC&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Client Keys
&lt;span class="go"&gt;&amp;lt;ca&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;-----BEGIN CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;-----END CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/ca&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;cert&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;-----BEGIN CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;-----END CERTIFICATE-----&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/cert&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;key&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;-----BEGIN RSA PRIVATE KEY-----&lt;/span&gt;
&lt;span class="go"&gt;-----END RSA PRIVATE KEY-----&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/key&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Copie o arquivo para sua m√°quina local, pode utilizar sftp ou scp. &lt;/p&gt;
&lt;p&gt;Ap√≥s seguir esses passos, sua vpn dever√° estar j√° criada e acess√≠vel. Realize os testes de acesso, sempre verificando os logs.&lt;/p&gt;
&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;</content><category term="sysadmin"></category><category term="VPN"></category><category term="Linux"></category></entry><entry><title>Dicas IPTables</title><link href="https://blog.chcdc.com.br/posts/dicas-iptables" rel="alternate"></link><published>2018-12-16T19:00:45-02:00</published><updated>2018-12-16T19:00:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-12-16:/posts/dicas-iptables</id><summary type="html">&lt;p&gt;Existem 3 tabelas gerenci√°veis no IPTables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FILTER - esta √© a tabela padr√£o, respons√°vel pela filtragens de pacotes. Possui tr√™s cadeias de conjuntos de regras:&lt;ul&gt;
&lt;li&gt;INPUT - pacotes destinados a sockets locais&lt;/li&gt;
&lt;li&gt;FORWARD - pacotes encaminhados (roteados) atrav√©s do firewall&lt;/li&gt;
&lt;li&gt;OUTPUT - pacotes gerados localmente&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NAT - √© uma tabela que √© consultada quando um ‚Ä¶&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Existem 3 tabelas gerenci√°veis no IPTables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;FILTER - esta √© a tabela padr√£o, respons√°vel pela filtragens de pacotes. Possui tr√™s cadeias de conjuntos de regras:&lt;ul&gt;
&lt;li&gt;INPUT - pacotes destinados a sockets locais&lt;/li&gt;
&lt;li&gt;FORWARD - pacotes encaminhados (roteados) atrav√©s do firewall&lt;/li&gt;
&lt;li&gt;OUTPUT - pacotes gerados localmente&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;NAT - √© uma tabela que √© consultada quando um pacote tenta criar uma nova conex√£o. Pode alterar caracter√≠sticas de origem ou de destino de um pacote. Possui tr√™s cadeias de conjuntos de regras:&lt;ul&gt;
&lt;li&gt;PREROUTING - utilizado para alterar um pacote, logo que √© recebido&lt;/li&gt;
&lt;li&gt;POSTROUTING - usado para alterar pacotes quando eles est√£o prestes a sair&lt;/li&gt;
&lt;li&gt;OUTPUT - usado para alterar pacotes gerados localmente&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;MANGLE - esta tabela √© usada para altera√ß√£o de pacotes. At√© o kernel vers√£o 2.4 esta tabela tinha apenas 2 cadeias, mas eles s√£o agora 5:&lt;ul&gt;
&lt;li&gt;PREROUTING - para alterar as conex√µes de entrada&lt;/li&gt;
&lt;li&gt;OUTPUT - para alterar pacotes gerados localmente&lt;/li&gt;
&lt;li&gt;INPUT - para pacotes de entrada&lt;/li&gt;
&lt;li&gt;POSTROUTING - para alterar pacotes quando eles est√£o prestes a sair&lt;/li&gt;
&lt;li&gt;FORWARD - pacotes encaminhados (roteados) atrav√©s do firewall&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;1 - Exibir todas as regras dispon√≠veis&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -L -n -v&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Se preferir, verificar apenas uma tabela em espec√≠fico (no caso a tabela nat):&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -t nat -L -n -v&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Ou atrav√©s de linhas numeradas:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -n -L -v --line-numbers&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2 - Bloquear endere√ßo IP espec√≠fico entrante na rede&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Para adicionar regra:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -s xxx.xxx.xxx.xxx -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Para remov√™-la:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -D INPUT -s xxx.xxx.xxx.xxx -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3 - Bloquear porta espec√≠fica&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Sainte:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A OUTPUT -p tcp --dport xxx -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Entrante:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp --dport xxx -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Ou m√∫ltiplas portas:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT  -p tcp -m multiport --dports 22,80,443 -j ACCEPT&lt;/code&gt;
&lt;code&gt;iptables -A OUTPUT -p tcp -m multiport --sports 22,80,443 -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4 - Permitir rede espec√≠fica acessar determinada porta:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A OUTPUT -p tcp -d 192.168.100.0/24 --dport  -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5 - Bloquear Network Flood sobre o servidor web que esteja escutando na porta 80&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Aceitando de 100 a 200 conex√µes por minuto (ajuste da maneira que achar melhor):&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp --dport  -m limit --limit 100/minute --limit-burst  -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;6 - Manter registros de Log‚Äôs de pacotes bloqueados:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -i eth0 -j LOG --log-prefix "Quantidade pacotes bloqueados:"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp -dport  -j LOG -log-prefix ‚ÄúServi√ßo: ftp‚Äù&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Os log‚Äôs s√£o salvos em /var/log/messages. Onde voc√™ poder√° filtrar usando comando grep:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;grep "Quantidade pacotes bloqueados:" /var/log/messages&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;7 -Limitar o n√∫mero de conex√µes simult√¢neas oriundas de determinado IP:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p tcp --syn --dport  -m connlimit --connlimit-above  -j REJECT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Onde, essa regra permitir√° 3 conex√µes simult√¢neas advindas de um mesmo endere√ßo IP na porta 22 (SSH).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;8 - Permitir conex√µes j√° estabelecidas:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9 - Bloquear Ping Requests:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -p icmp -icmp-type echo-request -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;10 - Bloquear por endere√ßo MAC:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;iptables -A INPUT -m mac --mac-source 00:00:00:00:00:00 -j DROP&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Simples assim! üòÜ&lt;/p&gt;</content><category term="Network"></category><category term="Sysadmin"></category></entry><entry><title>IPSec StrongSwan</title><link href="https://blog.chcdc.com.br/posts/ipsec-strongswan" rel="alternate"></link><published>2018-09-18T20:45:15-02:00</published><updated>2018-09-18T20:45:15-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-09-18:/posts/ipsec-strongswan</id><summary type="html">&lt;p&gt;Conforme mostrei nesse &lt;a href="https://blog.chcdc.com.br/posts/vpn-ipsec/"&gt;post&lt;/a&gt; vamos agora configurar uma VPN IPSec.&lt;/p&gt;
&lt;p&gt;Vamos utilizar o &lt;a href="https://www.strongswan.org/"&gt;StrongSwan&lt;/a&gt; para configurarmos a VPN IPSec. &lt;/p&gt;
&lt;p&gt;Os peers ser√£o configurados em dois ambientes distintos, Digital Ocean e AWS.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;A instala√ß√£o ser√° feita na distribui√ß√£o CentOS 7.5.1804x64.&lt;/p&gt;
&lt;p&gt;Para o ambiente amazon foi utilizado a inst√¢ncia Amazon ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Conforme mostrei nesse &lt;a href="https://blog.chcdc.com.br/posts/vpn-ipsec/"&gt;post&lt;/a&gt; vamos agora configurar uma VPN IPSec.&lt;/p&gt;
&lt;p&gt;Vamos utilizar o &lt;a href="https://www.strongswan.org/"&gt;StrongSwan&lt;/a&gt; para configurarmos a VPN IPSec. &lt;/p&gt;
&lt;p&gt;Os peers ser√£o configurados em dois ambientes distintos, Digital Ocean e AWS.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;A instala√ß√£o ser√° feita na distribui√ß√£o CentOS 7.5.1804x64.&lt;/p&gt;
&lt;p&gt;Para o ambiente amazon foi utilizado a inst√¢ncia Amazon Linux 2 AMI &lt;/p&gt;
&lt;p&gt;A VPN Site to Site precisa ser configurada dos dois lados, por isso, vamos configurar primeiro o servidor da esquerda (left) que ser√° a Digital Ocean.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Desabilitar SeLinux&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# sed -i &amp;#39;s/^SELINUX=.*/SELINUX=disabled/g&amp;#39; /etc/sysconfig/selinux &amp;amp;&amp;amp; cat /etc/sysconfig/selinux&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Atualizar o Sistema&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# yum -y update&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Reiniciar para aplicar as altera√ß√µes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# reboot&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Instale os pacotes necess√°rios&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;#  yum install -y vim epel-release&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Para a instala√ß√£o do lado amazon, vamos utilizar os reposit√≥rios Amazon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@peer-aws  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# amazon-linux-extras install epel -y&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Nesse caso, foi utilizado a √∫ltima vers√£o do pacote StrongSwan. Vers√£o 5.6.3&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# yum install strongswan -y&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Arquivo de configura√ß√£o lado esquerdo (left)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.conf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;config setup
    charondebug=&amp;quot;all&amp;quot;
    uniqueids=yes
    strictcrlpolicy=no

conn %default
    ikelifetime=60m
    mobike=yes
    ike=aes128-sha1-modp1536,3des-sha1-modp3072!
    esp=aes128-sha1-modp1536,3des-sha1-modp3072!

# Nome a ser utilizado para a conexao 
conn left

    left=xxx.xx.xxx.xxx
    leftsubnet=10.46.0.0/16
    leftid=xxx.xx.xxx.xx
    leftfirewall=yes

    # Outra Ponta
    right=xx.xx.xxx.xxx 
    rightsubnet=172.31.13.0/20
    rightid=xx.xx.xx.xxx

    # Fechar a VPN automaticamente
    auto=start
    # Ativar o Tunel , necessario quando existe NAT
    type=tunnel
    # Compressao
    compress=yes
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Gerando a chave secret para usar em ambos os lados
Existem N formas de gerar uma chave/password, nesse caso vamos utilizar o seguinte comando:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# date +%s | sha256sum | base64 | head -c 32 ; echo&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;O resultado apresentado foi:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;YmYyMzhiY2EwZWZjOGIzNzJiYjhkODRj&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Vamos editar o arquivo secrets&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.secrets&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ipsec.secrets - strongSwan IPsec secrets file&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;IP lado direito&amp;gt; : &amp;lt;Criptografia Usada&amp;gt; ‚Äú&amp;lt;Chave&amp;gt;‚Äù&lt;/span&gt;
xxx.xx.xx.xxx : PSK &lt;span class="s2"&gt;&amp;quot;YmYyMzhiY2EwZWZjOGIzNzJiYjhkODRj&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Setando strongswan para iniciar com o sistema / Iniciar strongswan&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl enable strongswan&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Ap√≥s a configura√ß√£o do left vamos iniciar o strongswan e partir para configurar o right.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl start strongswan&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Configurando lado direito (right)&lt;/h3&gt;
&lt;p&gt;Vamos partir do princ√≠pio que os passos 1 ao 4 j√° foram executados. Vamos configurar o nosso lado direito que no nosso caso √© a AWS&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arquivo de configura√ß√£o do lado direito (right)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.conf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;No caso da Amazon, temos que configurar o endere√ßo left com o IP da rede local, e o leftid com o IP externo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;config setup
        &lt;span class="nv"&gt;charondebug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;all&amp;quot;&lt;/span&gt;
        &lt;span class="nv"&gt;uniqueids&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes
        &lt;span class="nv"&gt;strictcrlpolicy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;no

&lt;span class="c1"&gt;# Preferencias padroes para todas as conexoes&lt;/span&gt;
conn %default
        &lt;span class="nv"&gt;ikelifetime&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;60m
        &lt;span class="nv"&gt;mobike&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes
        &lt;span class="nv"&gt;ike&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;aes128-sha1-modp1536,3des-sha1-modp3072!
        &lt;span class="nv"&gt;esp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;aes128-sha1-modp1536,3des-sha1-modp3072!

conn right
    &lt;span class="nv"&gt;left&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xxx.xx.xx.xxx
    &lt;span class="nv"&gt;leftsubnet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;172&lt;/span&gt;.31.13.0/20
    &lt;span class="nv"&gt;leftid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xxx.xxx.xx.xx
    &lt;span class="nv"&gt;leftfirewall&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes

    &lt;span class="nv"&gt;right&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xx.xx.xxx.xxx
    &lt;span class="nv"&gt;rightsubnet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;.46.0.0/16
    &lt;span class="nv"&gt;rightid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;xx.xx.xxx.xxx
    &lt;span class="nv"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;start
    &lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;tunnel
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Vamos configurar o secret&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# vim /etc/strongswan/ipsec.secrets&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Vamos inserir a mesma chave setada no left&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# ipsec.secrets - strongSwan IPsec secrets file&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;IP lado direito&amp;gt; : &amp;lt;Criptografia Usada&amp;gt; ‚Äú&amp;lt;Chave&amp;gt;‚Äù&lt;/span&gt;
xxx.xx.xxx.xxx : PSK &lt;span class="s2"&gt;&amp;quot;YmYyMzhiY2EwZWZjOGIzNzJiYjhkODRj&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Setando para iniciar com o sistema / iniciando o servi√ßo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl enable strongswan&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# systemctl start strongswan&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;Verificando conex√µes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lado Digital Ocean&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@ipsec-server  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# strongswan status left&lt;/span&gt;

Security Associations &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt; up, &lt;span class="m"&gt;0&lt;/span&gt; connecting&lt;span class="o"&gt;)&lt;/span&gt;:
         left&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;: ESTABLISHED &lt;span class="m"&gt;2&lt;/span&gt; minutes ago, xx.xx.xxx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xx.xx.xxx.xxx&lt;span class="o"&gt;]&lt;/span&gt;...xx.xxx.xxx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xx.xx.xxx.xxx&lt;span class="o"&gt;]&lt;/span&gt;
         left&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:  INSTALLED, TUNNEL, reqid &lt;span class="m"&gt;4&lt;/span&gt;, ESP in UDP SPIs: ca942554_i ce718f43_o
         left&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:   &lt;span class="m"&gt;10&lt;/span&gt;.46.0.0/16 &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="m"&gt;172&lt;/span&gt;.31.0.0/20
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Lado AWS&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;root@aws-peer  ~&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="c1"&gt;# strongswan status right&lt;/span&gt;

Security Associations &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; up, &lt;span class="m"&gt;0&lt;/span&gt; connecting&lt;span class="o"&gt;)&lt;/span&gt;:
right&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;: ESTABLISHED &lt;span class="m"&gt;3&lt;/span&gt; minutes ago, xxx.xx.xx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xx.xxx.xxx.xxx&lt;span class="o"&gt;]&lt;/span&gt;...xxx.xx.xx.xxx&lt;span class="o"&gt;[&lt;/span&gt;xxx.xx.xx.xxx&lt;span class="o"&gt;]&lt;/span&gt;
right&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:  INSTALLED, TUNNEL, reqid &lt;span class="m"&gt;1&lt;/span&gt;, ESP in UDP SPIs: ce718f43_i ca942554_o
right&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;:   &lt;span class="m"&gt;172&lt;/span&gt;.31.0.0/20 &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;.46.0.0/16
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Simples Assim :)&lt;/p&gt;</content><category term="IPSec"></category><category term="VPN"></category></entry><entry><title>VPN IPSec</title><link href="https://blog.chcdc.com.br/posts/vpn-ipsec" rel="alternate"></link><published>2018-09-15T01:59:44-02:00</published><updated>2018-09-15T01:59:44-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-09-15:/posts/vpn-ipsec</id><summary type="html">&lt;p&gt;√â um conjunto de protocolos que oferece uma seguran√ßa no nivel de camada IP. Sendo assim opera pela camada de rede (camada 3) do modelo OSI e modelo TCP/IP.&lt;/p&gt;
&lt;p&gt;O IPsec pode ser usado para proteger dados de rede, por exemplo, configurando circuitos usando o encapsulamento IPsec, no qual ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;√â um conjunto de protocolos que oferece uma seguran√ßa no nivel de camada IP. Sendo assim opera pela camada de rede (camada 3) do modelo OSI e modelo TCP/IP.&lt;/p&gt;
&lt;p&gt;O IPsec pode ser usado para proteger dados de rede, por exemplo, configurando circuitos usando o encapsulamento IPsec, no qual todos os dados enviados entre dois pontos de extremidade s√£o criptografados, como em uma conex√£o VPN ( Rede Virtual Privada ); para criptografar dados da camada de aplicativo ; e para fornecer seguran√ßa aos roteadores que enviam dados de roteamento pela Internet p√∫blica. O IPsec tamb√©m pode ser usado para fornecer autentica√ß√£o sem criptografia, por exemplo, para autenticar os dados originados de um remetente conhecido.&lt;/p&gt;
&lt;p&gt;O tr√°fego da Internet pode ser protegido de host para host sem o uso de IPsec, por exemplo, por criptografia na camada de aplicativo (Camada 7 do modelo OSI ) com HTTP Seguro (HTTPS) ou na camada de transporte (Camada 4 do modelo OSI) com o protocolo TLS ( Transport Layer Security ). No entanto, quando o tr√°fego usa criptografia ou autentica√ß√£o nessas camadas superiores, os agentes de amea√ßa ainda podem interceptar informa√ß√µes de protocolo que podem expor dados que devem ser criptografados. &lt;/p&gt;
&lt;p&gt;Pode usar criptografia para fornecer seguran√ßa. O IPsec pode ser usado para a configura√ß√£o de redes privadas virtuais (VPNs) de maneira segura.&lt;/p&gt;
&lt;!--more--&gt;

&lt;h3&gt;Protocolos IPSec&lt;/h3&gt;
&lt;p&gt;O IPsec √© definido para uso com as duas vers√µes atuais do Internet Protocol, IPv4 e IPv6, sendo obrigatorio em IPv6. Os cabe√ßalhos do protocolo IPsec s√£o inclu√≠dos no cabe√ßalho IP, onde aparecem como extens√µes de cabe√ßalho IP quando um sistema est√° usando IPsec.&lt;/p&gt;
&lt;p&gt;Os protocolos mais importantes considerados como parte do IPsec incluem:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;O Cabe√ßalho de Autentica√ß√£o de IP (AH), especificado no &lt;a href="https://tools.ietf.org/html/rfc4302"&gt;RFC 4302&lt;/a&gt;, define um cabe√ßalho de pacote opcional a ser usado para garantir a integridade sem conex√£o e a autentica√ß√£o de origem de dados para pacotes IP e para proteger contra replays.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;O IP Encapsulating Security Payload (ESP), especificado no &lt;a href="https://www.ietf.org/rfc/rfc4303.txt"&gt;RFC 4303&lt;/a&gt;, define um cabe√ßalho de pacote opcional que pode ser usado para fornecer confidencialidade atrav√©s de criptografia do pacote, bem como prote√ß√£o de integridade, autentica√ß√£o de origem de dados, controle de acesso e prote√ß√£o opcional contra replays ou an√°lise de tr√°fego.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;O IKE (Internet Key Exchange), definido no &lt;a href="https://tools.ietf.org/html/rfc7296"&gt;RFC 7296&lt;/a&gt;, "IKEv2 (Internet Key Exchange Protocol Version 2)", √© um protocolo definido para permitir que os hosts especifiquem quais servi√ßos devem ser incorporados nos pacotes, algoritmos criptogr√°ficos que ser√£o usados ‚Äã‚Äãpara fornecer esses servi√ßos e um mecanismo para compartilhar as chaves usadas com esses algoritmos criptogr√°ficos. &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Fases IPSec&lt;/h3&gt;
&lt;p&gt;O IPSec envolve muitas tecnologias de componentes e m√©todos de criptografia. No entanto, a opera√ß√£o do IPSec pode ser dividida em cinco etapas principais:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;"Interesting traffic"&lt;/strong&gt; Inicia o processo IPSec. O tr√°fego √© considerado interessante quando a pol√≠tica de seguran√ßa IPSec configurada nos pares IPSec inicia o processo IKE.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Fase IKE 1.&lt;/strong&gt;  O IKE autentica os pares IPSec e negocia os IKEs SA durante essa fase, configurando um canal seguro para negociar as SAs IPSec na fase 2.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Fase IKE 2.&lt;/strong&gt; IKE negocia os par√¢metros IPSec SA e configura as SAs IPSec correspondentes nos pares.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Transfer√™ncia de dados.&lt;/strong&gt; Os dados s√£o transferidos entre os pares IPSec com base nos par√¢metros IPSec e nas chaves armazenadas no banco de dados SA.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Termina√ß√£o de t√∫nel IPSec.&lt;/strong&gt; IPSec SAs terminam por exclus√£o ou por tempo limite.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Implementando o IPsec&lt;/h3&gt;
&lt;p&gt;O suporte a IPsec foi geralmente inclu√≠do na maioria dos sistemas operacionais comuns (e outros) dispon√≠veis desde o final dos anos 90, incluindo sistemas operacionais de desktop e servidor, bem como roteadores e outros dispositivos de seguran√ßa de rede.&lt;/p&gt;
&lt;p&gt;Embora os sistemas mais antigos possam suportar alguma vers√£o do IPsec, as empresas devem implantar o IPsec usando sistemas operacionais atualizados e atualizados em patches de seguran√ßa. Al√©m disso, sistemas mais antigos que suportam vers√µes mais antigas do IPsec e parecem ativar circuitos IPsec seguros podem, na verdade, n√£o manter os dados seguros. &lt;/p&gt;
&lt;p&gt;Nos proximos posts vamos configurar e implementar uma VPN IPSec.&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;Fontes:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc4302"&gt;RFC 4302&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.ietf.org/rfc/rfc4303.txt"&gt;RFC 4303&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://tools.ietf.org/html/rfc7296"&gt;RFC 7296&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.ciscopress.com/articles/article.asp?p=25474&amp;amp;seqNum=7"&gt;Cisco Press&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="IPSec"></category><category term="VPN"></category></entry><entry><title>Permissoes no Linux</title><link href="https://blog.chcdc.com.br/posts/permissoes-no-linux" rel="alternate"></link><published>2018-02-27T09:23:45-02:00</published><updated>2018-02-27T09:23:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-02-27:/posts/permissoes-no-linux</id><summary type="html">&lt;p&gt;As permiss√µes s√£o usadas para definir quem pode acessar determinados arquivos ou diret√≥rios, assim mantendo seguran√ßa e organiza√ß√£o em seu sistema e sua rede. &lt;/p&gt;
&lt;p&gt;Quando, em um sistema (li)Unix digitamos o comando &lt;code&gt;ls -l&lt;/code&gt; temos a seguinte visualiza√ß√£o:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ls -l" src="/images/ls_l.png"&gt;&lt;/p&gt;
&lt;p&gt;Vemos o primeiro item em cada linha √© a forma utilizada ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;As permiss√µes s√£o usadas para definir quem pode acessar determinados arquivos ou diret√≥rios, assim mantendo seguran√ßa e organiza√ß√£o em seu sistema e sua rede. &lt;/p&gt;
&lt;p&gt;Quando, em um sistema (li)Unix digitamos o comando &lt;code&gt;ls -l&lt;/code&gt; temos a seguinte visualiza√ß√£o:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ls -l" src="/images/ls_l.png"&gt;&lt;/p&gt;
&lt;p&gt;Vemos o primeiro item em cada linha √© a forma utilizada para mostrar as permissoes do arquivo.
O Linux trata todos os diret√≥rios como arquivos tamb√©m, portanto, as permiss√µes se aplicam de igual forma para ambos.&lt;/p&gt;
&lt;p&gt;O primeiro caractere aparece para indicar o tipo de arquivo:&lt;/p&gt;
&lt;p&gt;d =&amp;gt; diret√≥rio&lt;br&gt;
b =&amp;gt; arquivo de bloco&lt;br&gt;
c =&amp;gt; arquivo especial de caractere&lt;br&gt;
p =&amp;gt; canal&lt;br&gt;
s =&amp;gt; socket&lt;br&gt;
- =&amp;gt; arquivo "normal"  &lt;/p&gt;
&lt;p&gt;As permiss√µes v√£o definidas assim:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(r) Leitura&lt;/li&gt;
&lt;li&gt;(w) Escrita&lt;/li&gt;
&lt;li&gt;(x) Execu√ß√£o&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Como as permiss√µes s√£o divididas em 3, ir√° aparecer assim: &lt;/p&gt;
&lt;p&gt;(rwx)(rwx)(rwx) &lt;/p&gt;
&lt;p&gt;Tipo de permiss√£o Octal:&lt;br&gt;
4 - Indica permiss√£o de leitura;&lt;br&gt;
2 - Permiss√£o de escrita;&lt;br&gt;
1 - Indica permiss√£o de execu√ß√£o;&lt;br&gt;
0 - Indica sem permiss√µes.  &lt;/p&gt;
&lt;p&gt;Ent√£o a libera√ß√µes podem ser definidas somando as permiss√µes em octal, fazendo da seguinte forma:&lt;br&gt;
 4 + 2 + 1 = 7 (permiss√£o de rwx - Leitura, escrita e execu√ß√£o)&lt;br&gt;
 4 + 2 = 6     (permiss√£o rw - Leitura e escrita)&lt;br&gt;
 4 =           (permiss√£o r - Apenas Leitura)  &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;Usu√°rio&lt;/th&gt;
&lt;th align="center"&gt;Grupo&lt;/th&gt;
&lt;th align="center"&gt;Outros usu√°rios (n√£o donos)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;0&lt;/td&gt;
&lt;td align="center"&gt;0&lt;/td&gt;
&lt;td align="center"&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Leitura=negada&lt;/td&gt;
&lt;td align="center"&gt;Leitura=negada&lt;/td&gt;
&lt;td align="center"&gt;Leitura=negada&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Escrita=negada&lt;/td&gt;
&lt;td align="center"&gt;Escrita=negada&lt;/td&gt;
&lt;td align="center"&gt;Escrita=negada&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Execu√ß√£o=negada&lt;/td&gt;
&lt;td align="center"&gt;Execu√ß√£o=negada&lt;/td&gt;
&lt;td align="center"&gt;Execu√ß√£o=negada&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Simples Assim üòÉ&lt;/p&gt;</content><category term="Sysadmin"></category></entry><entry><title>Copiando arquivos com Python</title><link href="https://blog.chcdc.com.br/posts/copiando-arquivos-com-python" rel="alternate"></link><published>2018-02-14T10:55:25-02:00</published><updated>2018-02-14T10:55:25-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-02-14:/posts/copiando-arquivos-com-python</id><summary type="html">&lt;p&gt;Nesse &lt;a href="chcdc.com.br/posts/enviar-emails-com-python"&gt;post&lt;/a&gt; ensinei a criar um script basico para o envio de emails usando python.&lt;/p&gt;
&lt;p&gt;Vamos agora aprender a coletar os logs (ou arquivos que voce desejar) para anexar ao script de envio de emails.&lt;/p&gt;
&lt;p&gt;Lembrando que a vers√£o do Python que iremos trabalhar √© a &lt;strong&gt;3.6&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Antes de ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nesse &lt;a href="chcdc.com.br/posts/enviar-emails-com-python"&gt;post&lt;/a&gt; ensinei a criar um script basico para o envio de emails usando python.&lt;/p&gt;
&lt;p&gt;Vamos agora aprender a coletar os logs (ou arquivos que voce desejar) para anexar ao script de envio de emails.&lt;/p&gt;
&lt;p&gt;Lembrando que a vers√£o do Python que iremos trabalhar √© a &lt;strong&gt;3.6&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Antes de tudo vamos instalar o modulo &lt;a href="http://docs.paramiko.org/en/2.4/"&gt;Paramiko&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pip3.6 install paramiko
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Vamos inserir os modulos&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Come√ßamos importando os modulos necessarios para acessar e copiar os arquivos.
Os modulos que vamos utilizar s√£o &lt;a href="http://docs.paramiko.org/en/2.4/"&gt;Paramiko&lt;/a&gt; e o &lt;a href="https://docs.python.org/3.6/library/shutil.html"&gt;shutil&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Esse ultimo n√£o ser√° necessario a instala√ß√£o pois √© um dos modulos padr√µes do Python&lt;/p&gt;
&lt;p&gt;Inicialmente vamos abrir a conex√£o com servidor, passando por parametros as informa√ß√µes do host&lt;/p&gt;
&lt;p&gt;Podemos ver que usamos a porta padr√£o, porem n√£o esque√ßa de alterar caso seja diferente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;copyFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Abre a conex√£o&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSHClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Insere a chave do servidor remoto como confiavel&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_missing_host_key_policy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AutoAddPolicy&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="c1"&gt;# Carrega as chaves j√° inseridas&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_system_host_keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Efetua a conex√£o pela porta 22 com o usuario USER&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Agora vamos setar as vari√°veis, inserindo quais arquivos copiar&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    # Nome do arquivo a ser copiado
    files = [&amp;#39;NAME OF FILE&amp;#39;]
    # Caminho do arquivo, podemos setar diversos locais
    remote_images_path = &amp;#39;/path/remote/of/file/&amp;#39;
    # Caminho onde sera salvo o arquivo
    local_path = &amp;#39;/path/local/of/destiny/&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Vamos precisar de um &lt;code&gt;for&lt;/code&gt; para copiar os arquivo(s)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    # Abre a conex√¢o ftp
    sftp = s.open_sftp()
    for file in files:
        # Aqui setamos o caminho e o arquivo a ser copiado
        file_remote = remote_images_path + file
        # Aqui setamos o caminho local
        file_local = local_path + file

        # Exibe o caminho remoto sendo copiado para o caminho local
        print(file_remote + &amp;#39; &amp;gt;&amp;gt;&amp;gt;&amp;#39;  + file_local)
        # Efetua a copia
        sftp.get(file_remote, file_local)

        # Fecha as conex√µes
        sftp.close()
        s.close()
&lt;/pre&gt;&lt;/div&gt;


&lt;h6&gt;O script final ficar√° dessa forma&lt;/h6&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;paramiko&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;copyFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Abre a conex√£o&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSHClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Insere a chave do servidor remoto como confiavel&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_missing_host_key_policy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;paramiko&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AutoAddPolicy&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="c1"&gt;# Carrega as chaves j√° inseridas&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_system_host_keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Efetua a conex√£o pela porta 22 com o usuario USER&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HostIp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;USER&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Nome do arquivo a ser copiado&lt;/span&gt;
    &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NAME OF FILE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# Caminho do arquivo, podemos setar diversos locais&lt;/span&gt;
    &lt;span class="n"&gt;remote_images_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/path/remote/of/file/&amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;# Caminho onde sera salvo o arquivo&lt;/span&gt;
    &lt;span class="n"&gt;local_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/path/local/of/destiny/&amp;#39;&lt;/span&gt;

    &lt;span class="c1"&gt;# Abre a conex√£o ftp&lt;/span&gt;
    &lt;span class="n"&gt;sftp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open_sftp&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# Aqui setamos o caminho e o arquivo a ser copiado&lt;/span&gt;
        &lt;span class="n"&gt;file_remote&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;remote_images_path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt;
        &lt;span class="c1"&gt;# Aqui setamos o caminho local&lt;/span&gt;
        &lt;span class="n"&gt;file_local&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt;

        &lt;span class="c1"&gt;# Exibe o caminho remoto sendo copiado para o caminho local&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_remote&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;gt;&amp;gt;&amp;gt;&amp;#39;&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;file_local&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# Efetua a copia&lt;/span&gt;
        &lt;span class="n"&gt;sftp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file_remote&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_local&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# Fecha as conex√µes&lt;/span&gt;
        &lt;span class="n"&gt;sftp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;
&lt;p&gt;Qualquer duvida ou algo pra complementar deixe seu comentario.&lt;/p&gt;
&lt;p&gt;Fontes:&lt;/p&gt;
&lt;p&gt;‚Äì http://docs.paramiko.org/en/2.4/&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3.6/library/shutil.html&lt;/p&gt;</content><category term="script"></category></entry><entry><title>Enviar emails com Python</title><link href="https://blog.chcdc.com.br/posts/enviar-emails-com-python" rel="alternate"></link><published>2018-02-09T02:10:18-02:00</published><updated>2018-02-09T02:10:18-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-02-09:/posts/enviar-emails-com-python</id><summary type="html">&lt;p&gt;Hoje me foi proposto um desafio, coletar logs de um servidor via Telegram e enviar por email.&lt;/p&gt;
&lt;p&gt;Ap√≥s algumas horas em pesquisa, cheguei ao seguinte script que vou ensinar mais abaixo, primeiramente vamos fazer
o script de envio de emails.&lt;/p&gt;
&lt;p&gt;Antes de tudo, caso use GMail, voc√™ precisa permitir "aplicativos ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Hoje me foi proposto um desafio, coletar logs de um servidor via Telegram e enviar por email.&lt;/p&gt;
&lt;p&gt;Ap√≥s algumas horas em pesquisa, cheguei ao seguinte script que vou ensinar mais abaixo, primeiramente vamos fazer
o script de envio de emails.&lt;/p&gt;
&lt;p&gt;Antes de tudo, caso use GMail, voc√™ precisa permitir "aplicativos menos seguros" para executar seu script.&lt;/p&gt;
&lt;p&gt;A vers√£o do Python que iremos trabalhar √© a &lt;strong&gt;3.6&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Vamos come√ßar com um script simples,
existe uma biblioteca nativa em Python para enviar e-mails: smtplib. N√£o ser√° necess√°rio instalar bibliotecas externas!&lt;/p&gt;
&lt;p&gt;Para enviar um email b√°sico (sem linha de assunto), com um endere√ßo do Gmail, o c√≥digo √© bastante simples:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;smtp.gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;587&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starttls&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SEU EMAIL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA SENHA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;MENSAGEM!&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SEU EMAIL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;EMAIL DESTINO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Na linha 2, s√£o os par√¢metros para o servidor Gmail.
Primeiro, a localiza√ß√£o do servidor (ou endere√ßo IP), ent√£o a porta a ser usada.&lt;/p&gt;
&lt;p&gt;Na linha 3, h√° uma fun√ß√£o de seguran√ßa, necess√°ria para se conectar ao servidor do Gmail.
Ele proteger√° sua senha.&lt;/p&gt;
&lt;p&gt;N√£o podemos esquecer o endere√ßo de e-mail e senha na linha 4.&lt;/p&gt;
&lt;p&gt;A vari√°vel &lt;code&gt;msg&lt;/code&gt; conter√° sua mensagem e a linha 7 ir√° envi√°-la!&lt;/p&gt;
&lt;h2&gt;Para um email mais elaborado&lt;/h2&gt;
&lt;p&gt;Aqui j√° estamos inserindo alguns dados, como assunto, rementente.&lt;/p&gt;
&lt;p&gt;Para isso precisamos de mais modulos, j√° disponiveis na biblioteca basica do Python,
o &lt;strong&gt;&lt;em&gt;email.mime.multipart&lt;/em&gt;&lt;/strong&gt; e o &lt;strong&gt;&lt;em&gt;email.mime.text&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.multipart&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;
&lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.text&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;
&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt;  &lt;span class="n"&gt;fromaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SEU ENDERE√áO&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;7&lt;/span&gt;  &lt;span class="n"&gt;toaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ENDERE√áO DE DESTINO&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt;  &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;9&lt;/span&gt;  &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;From&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fromaddr&lt;/span&gt;
&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;To&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;
&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Subject&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ASSUNTO&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;12&lt;/span&gt;
&lt;span class="mi"&gt;13&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA MENSAGEM AQUI&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;14&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="mi"&gt;15&lt;/span&gt;
&lt;span class="mi"&gt;16&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;smtp.gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;587&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;17&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starttls&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;18&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA SENHA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;19&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_string&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;21&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;N√£o esque√ßa de alterar as seguinte linhas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Linha 6 Com seu endere√ßo de email&lt;/li&gt;
&lt;li&gt;Linha 7 O endere√ßo de email de destino&lt;/li&gt;
&lt;li&gt;Linha 11 com o assunto&lt;/li&gt;
&lt;li&gt;Linha 13 com a mensagem a ser enviada&lt;/li&gt;
&lt;li&gt;Linha 18 com a senha do seu email&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Para enviar um email com anexo&lt;/h2&gt;
&lt;p&gt;Para enviarmos anexos, vamos a um c√≥digo mais complicado. Percebi que todo mundo tem um m√©todo um pouco diferente pra fazer.
Fiz o codigo o mais simples possivel. Mas ainda vamos precisar de mais modulos.&lt;/p&gt;
&lt;p&gt;Em resumo, o passo essencial √© converter o arquivo em um Base64 antes de envi√°-lo. Meu c√≥digo funciona para arquivos de texto, arquivos pdf, imagens, arquivos de √°udio e arquivos de v√≠deo!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.multipart&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.text&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.base&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEBase&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;encoders&lt;/span&gt;


&lt;span class="n"&gt;fromaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SEU EMAIL&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;toaddr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;EMAIL DE DESTINO&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;From&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fromaddr&lt;/span&gt;
&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;To&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;
&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Subject&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ASSUNTO DO EMAIL&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;TEXTO A SER ENVIADO&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;NOME DO ARQUIVO OU EXTENS√ÉO&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;attachment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CAMINHO DO ARQUIVO&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;part&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEBase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;octet-stream&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_payload&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;attachment&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;encoders&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode_base64&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Disposition&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;attachment; filename= &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;part&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;smtp.gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;587&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;starttls&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SUA SENHA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_string&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fromaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;toaddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Esta feito o script de envio de emails.&lt;/p&gt;
&lt;p&gt;Em breve publico o script de coleta de logs e do BOT para o telegram.&lt;/p&gt;
&lt;p&gt;Simples Assim üòÜ&lt;/p&gt;
&lt;p&gt;Fontes:&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/smtplib.html&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/email.mime.html&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/email-examples.html&lt;/p&gt;
&lt;p&gt;‚Äì https://docs.python.org/3/library/email.html&lt;/p&gt;</content><category term="emails"></category><category term="script"></category></entry><entry><title>Gerando senhas com python</title><link href="https://blog.chcdc.com.br/posts/gerando-senhas-com-python" rel="alternate"></link><published>2018-01-09T19:48:25-02:00</published><updated>2018-01-09T19:48:25-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-01-09:/posts/gerando-senhas-com-python</id><summary type="html">&lt;p&gt;Nesse &lt;a href="http://chcdc.com.br/posts/gerando-senhas-seguras"&gt;post&lt;/a&gt; ensinei a usar o pwgen para criar senhas, por√©m ele n√£o tem me suprido pois necessito de senhas especificas.&lt;/p&gt;
&lt;p&gt;Preciso enviar senhas de comprimento oito e apenas numeros e letras minusculas.&lt;/p&gt;
&lt;p&gt;Resolvi criar ent√£o um script em Python para gerar essas senhas.&lt;/p&gt;
&lt;p&gt;Vamos come√ßar por partes&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Primeiro vamos ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nesse &lt;a href="http://chcdc.com.br/posts/gerando-senhas-seguras"&gt;post&lt;/a&gt; ensinei a usar o pwgen para criar senhas, por√©m ele n√£o tem me suprido pois necessito de senhas especificas.&lt;/p&gt;
&lt;p&gt;Preciso enviar senhas de comprimento oito e apenas numeros e letras minusculas.&lt;/p&gt;
&lt;p&gt;Resolvi criar ent√£o um script em Python para gerar essas senhas.&lt;/p&gt;
&lt;p&gt;Vamos come√ßar por partes&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Primeiro vamos definir o executavel e importar os modulos &lt;strong&gt;random&lt;/strong&gt; e &lt;strong&gt;string&lt;/strong&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/local/bin/python3.6&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;string&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Vamos criar uma fun√ß√£o para gerar os numeros randomicos.&lt;/p&gt;
&lt;p&gt;Atribuiremos a variavel &lt;strong&gt;char&lt;/strong&gt; os caracteres minusculos e digitos numericos&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;randompassword&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascii_lowercase&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;passw&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;passw&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Perguntaremos a quantidade de senhas necessarias e o comprimento, as respostas ser√£o
armazenadas nas variaveis &lt;strong&gt;amount&lt;/strong&gt; e &lt;strong&gt;number&lt;/strong&gt; respectivamente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;amount&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Quantas senhas:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Qual o comprimento da senha?&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Agora para cada quantidade declarada na variavel &lt;strong&gt;amount&lt;/strong&gt; vamos imprimir uma
senha gerada randomicamente.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Senha: {i} - {randompassword(number)} &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;O codigo final ficar√° dessa forma:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/local/bin/python3.6&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;string&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;randompassword&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;chars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascii_lowercase&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;passw&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;chars&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;passw&lt;/span&gt;

&lt;span class="n"&gt;amount&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Quantas senhas:&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Qual o comprimento da senha?&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;   Senha: {i} - {randompassword(number)} &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Algo simples, mas pode ser implementado em outros codigos, e claro pode ser melhorado.&lt;/p&gt;
&lt;p&gt;Esse script encontra-se no meu &lt;a href="https://github.com/chcdc/scripts/blob/master/Python/generate_pass.py"&gt;Github&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Simples Assim üòÉ&lt;/p&gt;</content></entry><entry><title>2017</title><link href="https://blog.chcdc.com.br/posts/2017" rel="alternate"></link><published>2018-01-01T12:00:45-02:00</published><updated>2018-01-01T12:00:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2018-01-01:/posts/2017</id><summary type="html">&lt;p&gt;E l√° vamos n√≥s recome√ßar.&lt;/p&gt;
&lt;p&gt;2017 pubiquei apenas um artigo aqui, enfrentei diversas dificuldades, tais como a perda de meu pai.&lt;/p&gt;
&lt;p&gt;Nesse ano que se inicia pretendo me dedicar mais ao blog e ao conteudo postado.&lt;/p&gt;
&lt;p&gt;A base do blog foi alterada de Octopress (Ruby) para Pelican (Python)&lt;/p&gt;
&lt;p&gt;Sendo Python ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;E l√° vamos n√≥s recome√ßar.&lt;/p&gt;
&lt;p&gt;2017 pubiquei apenas um artigo aqui, enfrentei diversas dificuldades, tais como a perda de meu pai.&lt;/p&gt;
&lt;p&gt;Nesse ano que se inicia pretendo me dedicar mais ao blog e ao conteudo postado.&lt;/p&gt;
&lt;p&gt;A base do blog foi alterada de Octopress (Ruby) para Pelican (Python)&lt;/p&gt;
&lt;p&gt;Sendo Python uma das minhas linguagens preferidas, o blog ser√° mais prazeroso de manter.&lt;/p&gt;
&lt;p&gt;J√° tenho diversas coisas e ideias pra fazer aqui, como por exemplo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Melhorar o layout&lt;/li&gt;
&lt;li&gt;Inserir menus&lt;/li&gt;
&lt;li&gt;Inserir compartilhamento&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Isso e muito mais pretendo entregar.&lt;/p&gt;
&lt;p&gt;E l√° vamos n√≥s&lt;/p&gt;
&lt;p&gt;Feliz 2018 üòÜ&lt;/p&gt;</content><category term="misc"></category><category term="Vida Pessoal"></category></entry><entry><title>Organizando arquivos por extens√£o usando Python</title><link href="https://blog.chcdc.com.br/posts/organizando-arquivos-por-extensao-usando-python" rel="alternate"></link><published>2017-01-25T11:45:45-02:00</published><updated>2017-01-25T11:45:45-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2017-01-25:/posts/organizando-arquivos-por-extensao-usando-python</id><summary type="html">&lt;p&gt;Recentemente fiz download de milhares de arquivos em pdf (n√£o foi pirataria ok?!)  e precisava organizar eles em uma pasta especifica.&lt;/p&gt;
&lt;p&gt;Pesquisei diversas formas de fazer isso, poderia fazer facilmente em &lt;strong&gt;Shell Script&lt;/strong&gt; mas como estou aprendendo &lt;strong&gt;Python&lt;/strong&gt; aceitei o desafio.&lt;/p&gt;
&lt;p&gt;Bom vamos ao c√≥digo.&lt;/p&gt;
&lt;!--more--&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env Python3.5 ‚Ä¶&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;Recentemente fiz download de milhares de arquivos em pdf (n√£o foi pirataria ok?!)  e precisava organizar eles em uma pasta especifica.&lt;/p&gt;
&lt;p&gt;Pesquisei diversas formas de fazer isso, poderia fazer facilmente em &lt;strong&gt;Shell Script&lt;/strong&gt; mas como estou aprendendo &lt;strong&gt;Python&lt;/strong&gt; aceitei o desafio.&lt;/p&gt;
&lt;p&gt;Bom vamos ao c√≥digo.&lt;/p&gt;
&lt;!--more--&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env Python3.5&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;# Carlos Carvalho&lt;/span&gt;
&lt;span class="c1"&gt;# 21/01/2017&lt;/span&gt;
&lt;span class="c1"&gt;# Copiar/mover arquivos por extens√£o&lt;/span&gt;
&lt;span class="c1"&gt;# Copiar os arquivos em pdf do diretorio /mnt/DOCS/&lt;/span&gt;
&lt;span class="c1"&gt;# para o diretorio /mnt/DOCS/pdf&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nn"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="nn"&gt;re&lt;/span&gt;

&lt;span class="c1"&gt;#Regex para identificar os arquivos em pdf&lt;/span&gt;
&lt;span class="n"&gt;filePattern&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;^(.*?)(.pdf)$&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;VERBOSE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Percorre o diretorio com um loop&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;amerFilename&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/mnt/DOCS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;mo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;filePattern&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Ignora os arquivos que n√£o s√£o pdf&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mo&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;

    &lt;span class="c1"&gt;# Obtem as diferentes partes do nome do arquivo&lt;/span&gt;
    &lt;span class="n"&gt;beforePart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;findPart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


    &lt;span class="c1"&gt;# Obtem os paths absolutos do arquivo&lt;/span&gt;
    &lt;span class="n"&gt;absWorkingDir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/mnt/DOCS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;PathFileEnd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/mnt/DOCS/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;amerFilename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;absWorkingDir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;PathFileEnd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;absWorkingDir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PathFileEnd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Move os arquivos&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Moving &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt; to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt; .. &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PathFileEnd&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amerFilename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;PathFileEnd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="regex"></category></entry><entry><title>Criando um Bot do Telegram</title><link href="https://blog.chcdc.com.br/posts/criando-um-bot-do-telegram" rel="alternate"></link><published>2016-09-18T20:14:12-03:00</published><updated>2016-09-18T20:14:12-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-09-18:/posts/criando-um-bot-do-telegram</id><summary type="html">&lt;p&gt;Sim, resolvi me aventurar no desenvolvimento de um bot utilizando a &lt;a href="https://core.telegram.org/bots/api"&gt;API do Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Irei contar a minha saga da cria√ß√£o desse bot nesse maravilhoso &lt;a href="https://telegram.org"&gt;Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pra fazer um bot novo, √© muito simples.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Irei partir do principio que voc√™ j√° tenha o Telegram instalado em seu smartphone e/ou ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Sim, resolvi me aventurar no desenvolvimento de um bot utilizando a &lt;a href="https://core.telegram.org/bots/api"&gt;API do Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Irei contar a minha saga da cria√ß√£o desse bot nesse maravilhoso &lt;a href="https://telegram.org"&gt;Telegram&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pra fazer um bot novo, √© muito simples.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Irei partir do principio que voc√™ j√° tenha o Telegram instalado em seu smartphone e/ou computador  e que saiba o basico dele.&lt;/p&gt;
&lt;!--![BotFather](../images/Bot.png)--&gt;

&lt;ul&gt;
&lt;li&gt;Adicione o @BotFather&lt;/li&gt;
&lt;li&gt;Escreva: /newbot&lt;/li&gt;
&lt;li&gt;Ele pedir√° um nome para o seu bot. Escreva o nome finalizado com _bot&lt;/li&gt;
&lt;li&gt;Se o nome estiver dispon√≠vel,o bot ser√° criado e voc√™ receber√° um token de acesso.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para testar seu bot acesse o seguinte link&lt;br&gt;
   https://api.telegram.org/bot[token]/getUpdates&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;Dever√° receber a seguinte resposta:&lt;br&gt;
   &lt;code&gt;{"ok":true,"result":[{}]"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Simples assim.&lt;/p&gt;</content><category term="Telegram"></category><category term="bot"></category></entry><entry><title>Monitorar conexoes</title><link href="https://blog.chcdc.com.br/posts/monitorar-conexoes" rel="alternate"></link><published>2016-07-20T04:06:37-03:00</published><updated>2016-07-20T04:06:37-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-07-20:/posts/monitorar-conexoes</id><summary type="html">&lt;p&gt;O tcpdump √© um famoso sniffer para sistemas Linux. Muito util para analise  e solu√ß√£o de problemas da rede.&lt;/p&gt;</summary><content type="html">&lt;p&gt;O tcpdump √© um famoso sniffer para sistemas Linux. Muito util para analise  e solu√ß√£o de problemas da rede.&lt;/p&gt;
&lt;p&gt;Sua documenta√ß√£o pode ser encontrada no site oficial.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.tcpdump.org"&gt;TCPDUMP&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;A maioria das distribui√ß√µes linux possuem binarios, caso n√£o possua, sua instala√ß√£o √© bem simples.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    sudo apt-get install tcpdump
&lt;/pre&gt;&lt;/div&gt;


&lt;!--more--&gt;

&lt;p&gt;Inicialmente n√£o √© necessario um parametro para sua execu√ß√£o, voc√™ apenas precisa executar como root, pois o tcpdump ir√° colocar sua placa de rede em modo promiscuo.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Por√©m podemos utilizar diversos filtros por meio de parametros&lt;/p&gt;
&lt;p&gt;Por padr√£o ele faz a captura da placa de rede ativa.Para selecionar a placa, devemos utilizar o parametro -i seguido da placa a ser monitorada&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump -i eth0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Podemos monitorar conexoes de origem utilizando o parametro &lt;em&gt;-src host&lt;/em&gt;. Tudo que vier do nosso gateway (192.168.1.1) para o nosso computador ( 192.168.1.10 ), ser√° monitorado com o seguinte comando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump -i eth0 src &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Se quisermos monitorar da forma inversa.Tudo que sair de nosso computador (192.168.1.10) para o nosso gateway, o comando ser√° o seguinte&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump -i eth0 dst &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Tamb√©m √© possivel especificar a porta de origem e destino com o comando &lt;em&gt;src port&lt;/em&gt; e &lt;em&gt;dst port&lt;/em&gt; . Um exemplo √© monitorar a porta 443&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump -i eth0 dst port &lt;span class="m"&gt;443&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para que o tcpdump n√£o converta os endere√ßos e portas, devemos utilizar o parametro &lt;em&gt;-n&lt;/em&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump -i eth0 -n host www.google.com.br
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Podemos tambem utilizar operadores booleanos para um filtro mais refinado.&lt;/p&gt;
&lt;p&gt;Por exemplo, capturar todos os pacotes da porta 80 e 443 da rede 192.168.1.0/16&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    tcpdump -i eth0 -n net &lt;span class="m"&gt;192&lt;/span&gt;.168 and port &lt;span class="m"&gt;80&lt;/span&gt; and port &lt;span class="m"&gt;443&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Muitas op√ß√µes podem ser obtidas com o tcpdump, essas s√£o algumas op√ß√µes basicas pra iniciar com sniffers.&lt;/p&gt;</content></entry><entry><title>Instalando Telegram-Cli</title><link href="https://blog.chcdc.com.br/posts/instalando-telegram-cli" rel="alternate"></link><published>2016-04-22T20:43:33-03:00</published><updated>2016-04-22T20:43:33-03:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-04-22:/posts/instalando-telegram-cli</id><summary type="html">&lt;p&gt;Telegram-CLI √© um cliente do Telegram baseado na linguagem lua, ele √© executado a partir do terminal.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Instale as dependencias&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt-get install libreadline-dev libconfig-dev libssl-dev
 lua5.2 liblua5.2-dev libevent-dev libjansson-dev libpython-dev
 make git-core
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Navege at√© o diretorio de instalacao&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd /opt/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Fa√ßa o clone do repositorio&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone --recursive ‚Ä¶&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;Telegram-CLI √© um cliente do Telegram baseado na linguagem lua, ele √© executado a partir do terminal.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Instale as dependencias&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;apt-get install libreadline-dev libconfig-dev libssl-dev
 lua5.2 liblua5.2-dev libevent-dev libjansson-dev libpython-dev
 make git-core
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Navege at√© o diretorio de instalacao&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd /opt/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Fa√ßa o clone do repositorio&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone --recursive https://github.com/vysheng/tg.git &amp;amp;&amp;amp; cd tg
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Compile&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./configure
make
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pronto, o proximo passo √© a configura√ß√£o do Telegram&lt;/p&gt;
&lt;p&gt;Acesse a pasta do executavel&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd /opt/tg/bin
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Execute o Telegram-Cli com o seguinte comando:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/opt/tg/bin/telegram-cli -W -k tg-server.pub
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Na primeira execu√ß√£o ser√° solicitado o numero de telefone e o codigo que ser√° enviado por sms&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Telegram-cli version 1.2.0, Copyright (C) 2013-2015 Vitaly Valtman
Telegram-cli comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show_license&amp;#39; for details.
Telegram-cli uses libtgl version 1.2.0
I: config dir=[~/.telegram-cli]
[~/.telegram-cli] created
[~/.telegram-cli/downloads] created
phone number: +554499999999 &amp;lt;--colocar aqui seu n√∫mero de telefone
code (&amp;#39;call&amp;#39; for phone call): 12345 &amp;lt;-- colocar aqui o c√≥digo que
                            o pr√≥prio Telegram enviar√° por SMS
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pronto! Est√° configurado!&lt;/p&gt;
&lt;p&gt;Para enviar mensagens basta executar:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/opt/tg/bin/telegram-cli -W -k tg-server.pub
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Configurar para envio de notifica√ß√µes via sistema&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;Ap√≥s o telegram-cli estar instalado e configurado, crie o seguinte arquivo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo vim /etc/profile.d/TelNotdata.sh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Acrescente o conteudo&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelNotIP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;hostname -I&lt;span class="p"&gt;|&lt;/span&gt;sed &lt;span class="s1"&gt;&amp;#39;s/[ ]*$//&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelNotPort&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;8080&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TempFileDir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/var/tmp/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramHomePath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/opt/tg/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramScriptPath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramHomePath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;scripts/user/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramGenericPath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramHomePath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;scripts/generic/&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramScript&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramGenericPath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;telegram.sh&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramCli&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramHomePath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;bin/telegram-cli&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramLog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TempFileDir&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;tg.log&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;ReceiveLua&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$TelegramGenericPath&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;receive.lua&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;TelegramTo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;PrimeiroNome_SegundoNome&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;EmailTo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;seu@email.com&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Torne ele executavel&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo chmod +x /etc/profile.d/TelNotdata.sh
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;De um start no Daemon do Telegram-CLI&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/opt/tg/bin/telegram-cli -vvvvRC -k tg-server.pub -W -dL tg.log -P 1234 &amp;amp;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Verifique se esta rodando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ps -ef | grep telegram
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;A saida √© algo parecido com isso&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;root 1736  978  0 01:53 pts/0  00:00:01 bin/telegram-cli -vvvvRC -k tg-server.pub -W -dL tg.log -P 1234
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para enviar mensagens √© simples!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;echo &amp;quot;msg Firstname_Surname Test123&amp;quot; | nc 127.0.0.1 1234
echo &amp;quot;send_text Firstname_Surname  switch_icons.txt&amp;quot; | nc 127.0.0.1 1234
echo &amp;quot;send_photo Firstname_Surname  logo.png&amp;quot; | nc 127.0.0.1 1234
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Dessa forma, voce pode criar scripts para enviar mensagens automaticas, 
inclusive quando ocorrer algo no servidor&lt;/p&gt;</content></entry><entry><title>Gerando senhas seguras</title><link href="https://blog.chcdc.com.br/posts/gerando-senhas-seguras" rel="alternate"></link><published>2016-01-20T01:48:25-02:00</published><updated>2016-01-20T01:48:25-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-01-20:/posts/gerando-senhas-seguras</id><summary type="html">&lt;p&gt;Frequentemente preciso enviar senhas de VPN para clientes, criar ou alterar senhas novas para os servidores.
Existem diversas ferramentas online que isso possa ser feito, mas ao meu ver, o tempo que demoro em acessar essas ferramentas se torna muito grande.
Ap√≥s algumas pesquisas encontrei um pacote que pode fazer ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Frequentemente preciso enviar senhas de VPN para clientes, criar ou alterar senhas novas para os servidores.
Existem diversas ferramentas online que isso possa ser feito, mas ao meu ver, o tempo que demoro em acessar essas ferramentas se torna muito grande.
Ap√≥s algumas pesquisas encontrei um pacote que pode fazer isso pelo terminal.&lt;/p&gt;
&lt;p&gt;Para instalar vamos baixar e compilar o pacote.&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Primeiramente vamos baixar o source do pacote&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    wget http://downloads.sourceforge.net/project/pwgen/pwgen/2.07/pwgen-2.07.tar.gz
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;br&gt;
Vamos descompactar o arquivo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    $ tar xvf pwgen-2.07.tar.gz
    $ &lt;span class="nb"&gt;cd&lt;/span&gt; pwgen-2.07
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Agora vamos compilar&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    $ ./configure
    $ make
    $ sudo make install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Agora √© s√≥ usar o comando&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    $ pwgen
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Por padr√£o ele gera uma sequencia de caracteres alfanumericos maiusculos e minusculos e numeros com 8 caracteres. Mas caso queira, voc√™ pode definir o tamanho maior para as senhas.&lt;/p&gt;
&lt;p&gt;&lt;img alt="pwgen-pass" src="../images/pass-pwgen.png"&gt;
Por exemplo, gerar senhas com 20 caracteres.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    $ pwgen &lt;span class="m"&gt;20&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="pwgen" src="../images/pwgen-20.png"&gt;
Voc√™ pode gerar senhas de infinitas formas, para isso, basta ler o arquivo helper usando o parametro -h&lt;/p&gt;
&lt;p&gt;&lt;img alt="pewgen-help" src="../images/pwgen-help.png"&gt;&lt;/p&gt;
&lt;p&gt;Simples assim :)&lt;/p&gt;</content></entry><entry><title>Registro de acesso</title><link href="https://blog.chcdc.com.br/posts/registro-de-acesso" rel="alternate"></link><published>2016-01-05T01:59:44-02:00</published><updated>2016-01-05T01:59:44-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-01-05:/posts/registro-de-acesso</id><summary type="html">&lt;p&gt;Tenho um notebook que fica grande parte do tempo no meu quarto, ent√£o quando n√£o estou em casa, fica liberado para alguem usar.&lt;/p&gt;
&lt;p&gt;Mas a√≠ pensei, como saber em tempo real quem acessou minha maquina? A solu√ß√£o √© simples!&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Criei um script pra cada vez que houver logon no sistema ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Tenho um notebook que fica grande parte do tempo no meu quarto, ent√£o quando n√£o estou em casa, fica liberado para alguem usar.&lt;/p&gt;
&lt;p&gt;Mas a√≠ pensei, como saber em tempo real quem acessou minha maquina? A solu√ß√£o √© simples!&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Criei um script pra cada vez que houver logon no sistema tira uma foto e envia ao meu Email!&lt;/p&gt;
&lt;p&gt;O script √© bem simples:&lt;/p&gt;
&lt;p&gt;[gist:id=129b0f739b27db186eb7]&lt;/p&gt;
&lt;p&gt;Os comandos se resumem no seguinte:&lt;/p&gt;
&lt;p&gt;&lt;b&gt;&lt;code&gt;now=date +%Y%m%d-%H%M%S&lt;/code&gt;&lt;/b&gt; Variavel que recebe a data atual do sistema.
&lt;br&gt;&lt;code&gt;fswebcam&lt;/code&gt; - Software que permite tirar fotos a partir do terminal
    &lt;br&gt; - &lt;code&gt;-F&lt;/code&gt; Define o numero de Frames para captar
    &lt;br&gt; - &lt;code&gt;-r&lt;/code&gt; Define a resolu√ß√£o da captura
    &lt;br&gt; - &lt;code&gt;--jpeg 100&lt;/code&gt; Formato e qualidade da saida
    &lt;br&gt; - &lt;code&gt;-D 1&lt;/code&gt; Tempo de delay para a captura
    &lt;br&gt; - &lt;code&gt;$now.jpeg&lt;/code&gt; Arquivo que ser√° salvo&lt;/p&gt;
&lt;p&gt;&lt;b&gt;&lt;code&gt;sendemail&lt;/code&gt; &lt;/b&gt; - Software de envio de emails
    &lt;br&gt;  - &lt;code&gt;-f&lt;/code&gt; [FROM] Email do remetente
    &lt;br&gt;  - &lt;code&gt;-t&lt;/code&gt; [TO] Email de destino
    &lt;br&gt;  - &lt;code&gt;-u&lt;/code&gt; [Subject] Assunto
    &lt;br&gt;  - &lt;code&gt;-m&lt;/code&gt; [Message] Mensagem do email
    &lt;br&gt;  - &lt;code&gt;-s&lt;/code&gt; [SMTP] Servidor de Saida SMTP
    &lt;br&gt;  - &lt;code&gt;-xu&lt;/code&gt; [Username] Conta de email que sera utilizada para envio
    &lt;br&gt;  - &lt;code&gt;-xp&lt;/code&gt; [ Password] Senha
    &lt;br&gt;  - &lt;code&gt;-a&lt;/code&gt; [FILE] Anexo do Email&lt;/p&gt;
&lt;p&gt;Simples assim :)&lt;/p&gt;</content><category term="sysadmin"></category></entry><entry><title>Removendo v√°rios arquivos de uma lista gigante</title><link href="https://blog.chcdc.com.br/posts/removendo-varios-arquivos-de-uma-lista-gigante" rel="alternate"></link><published>2016-01-02T23:39:17-02:00</published><updated>2016-01-02T23:39:17-02:00</updated><author><name>Carlos Carvalho</name></author><id>tag:blog.chcdc.com.br,2016-01-02:/posts/removendo-varios-arquivos-de-uma-lista-gigante</id><summary type="html">&lt;p&gt;Por experi√™ncia pr√≥pria, vez por outra preciso apagar v√°rios arquivos gigantescos (geralmente logs) de uma √∫nica vez e a seguinte mensagem √© gerada:&lt;/p&gt;
&lt;p&gt;/bin/rm Argument list too long (Lista de argumento muito longa)&lt;/p&gt;
&lt;p&gt;E da√≠, o que fazer?&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Basta entrar no diret√≥rio onde encontram-se os arquivos e executar algumas ‚Ä¶&lt;/p&gt;</summary><content type="html">&lt;p&gt;Por experi√™ncia pr√≥pria, vez por outra preciso apagar v√°rios arquivos gigantescos (geralmente logs) de uma √∫nica vez e a seguinte mensagem √© gerada:&lt;/p&gt;
&lt;p&gt;/bin/rm Argument list too long (Lista de argumento muito longa)&lt;/p&gt;
&lt;p&gt;E da√≠, o que fazer?&lt;/p&gt;
&lt;!--more--&gt;

&lt;p&gt;Basta entrar no diret√≥rio onde encontram-se os arquivos e executar algumas das alternativas de comando.&lt;/p&gt;
&lt;p&gt;Para apagar todos os arquivos que contenham "2015" em seu nome:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    $ &lt;span class="k"&gt;for&lt;/span&gt; a in *2015*&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; rm &lt;span class="nv"&gt;$a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Para apagar todos os arquivos que possuam a extens√£o .log:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    $ &lt;span class="k"&gt;for&lt;/span&gt; a in *.log&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; rm &lt;span class="nv"&gt;$a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Bem simples! :)&lt;/p&gt;</content><category term="sysadmin"></category></entry></feed>